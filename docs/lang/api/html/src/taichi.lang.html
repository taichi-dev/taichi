
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>taichi.lang package &#8212; taichi-api-docstring  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="taichi-lang-package">
<h1>taichi.lang package<a class="headerlink" href="#taichi-lang-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-taichi.lang.ast_checker">
<span id="taichi-lang-ast-checker-module"></span><h2>taichi.lang.ast_checker module<a class="headerlink" href="#module-taichi.lang.ast_checker" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.ast_checker.KernelSimplicityASTChecker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.ast_checker.</span></span><span class="sig-name descname"><span class="pre">KernelSimplicityASTChecker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ast_checker.KernelSimplicityASTChecker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ast.NodeVisitor</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.ast_checker.KernelSimplicityASTChecker.generic_visit">
<span class="sig-name descname"><span class="pre">generic_visit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ast_checker.KernelSimplicityASTChecker.generic_visit" title="Permalink to this definition">¶</a></dt>
<dd><p>Called if no explicit visitor function exists for a node.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-taichi.lang.ast_resolver">
<span id="taichi-lang-ast-resolver-module"></span><h2>taichi.lang.ast_resolver module<a class="headerlink" href="#module-taichi.lang.ast_resolver" title="Permalink to this headline">¶</a></h2>
<p>Provides helpers to resolve AST nodes.</p>
<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.ast_resolver.ASTResolver">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.ast_resolver.</span></span><span class="sig-name descname"><span class="pre">ASTResolver</span></span><a class="headerlink" href="#taichi.lang.ast_resolver.ASTResolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Provides helper methods to resolve AST nodes.</p>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.ast_resolver.ASTResolver.resolve_to">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">resolve_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wanted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scope</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ast_resolver.ASTResolver.resolve_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if symbol <code class="docutils literal notranslate"><span class="pre">node</span></code> resolves to <code class="docutils literal notranslate"><span class="pre">wanted</span></code> object.</p>
<p>This is only intended to check if a given AST node resolves to a symbol
under some namespaces, e.g. the <code class="docutils literal notranslate"><span class="pre">a.b.c.foo</span></code> pattern, but not meant for
more complicated expressions like <code class="docutils literal notranslate"><span class="pre">(a</span> <span class="pre">+</span> <span class="pre">b).foo</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> (<em>Union</em><em>[</em><em>ast.Attribute</em><em>, </em><em>ast.Name</em><em>]</em>) – an AST node to be resolved.</p></li>
<li><p><strong>wanted</strong> (<em>Any</em>) – The expected python object.</p></li>
<li><p><strong>scope</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Maps from symbol names to objects, for
example, globals()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The checked result.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-taichi.lang.common_ops">
<span id="taichi-lang-common-ops-module"></span><h2>taichi.lang.common_ops module<a class="headerlink" href="#module-taichi.lang.common_ops" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.common_ops.TaichiOperations">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.common_ops.</span></span><span class="sig-name descname"><span class="pre">TaichiOperations</span></span><a class="headerlink" href="#taichi.lang.common_ops.TaichiOperations" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The base class of taichi operations of expressions. Subclasses: <a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.common_ops.TaichiOperations.assign">
<span class="sig-name descname"><span class="pre">assign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.common_ops.TaichiOperations.assign" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign the expression of the given operand to self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Any</em>) – Given operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The expression after assigning.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.common_ops.TaichiOperations.atomic_add">
<span class="sig-name descname"><span class="pre">atomic_add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.common_ops.TaichiOperations.atomic_add" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the new expression of computing atomic add between self and a given operand.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Any</em>) – Given operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The computing expression of atomic add.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.common_ops.TaichiOperations.atomic_and">
<span class="sig-name descname"><span class="pre">atomic_and</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.common_ops.TaichiOperations.atomic_and" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the new expression of computing atomic and between self and a given operand.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Any</em>) – Given operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The computing expression of atomic and.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.common_ops.TaichiOperations.atomic_or">
<span class="sig-name descname"><span class="pre">atomic_or</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.common_ops.TaichiOperations.atomic_or" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the new expression of computing atomic or between self and a given operand.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Any</em>) – Given operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The computing expression of atomic or.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.common_ops.TaichiOperations.atomic_sub">
<span class="sig-name descname"><span class="pre">atomic_sub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.common_ops.TaichiOperations.atomic_sub" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the new expression of computing atomic sub between self and a given operand.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Any</em>) – Given operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The computing expression of atomic sub.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.common_ops.TaichiOperations.atomic_xor">
<span class="sig-name descname"><span class="pre">atomic_xor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.common_ops.TaichiOperations.atomic_xor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the new expression of computing atomic xor between self and a given operand.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Any</em>) – Given operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The computing expression of atomic xor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.common_ops.TaichiOperations.augassign">
<span class="sig-name descname"><span class="pre">augassign</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.common_ops.TaichiOperations.augassign" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the computing expression between self and the given operand of given operator and assigned to self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Any</em>) – Given operand.</p></li>
<li><p><strong>op</strong> (<em>str</em>) – The name of operator.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.common_ops.TaichiOperations.logical_and">
<span class="sig-name descname"><span class="pre">logical_and</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.common_ops.TaichiOperations.logical_and" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the new expression of computing logical and between self and a given operand.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Any</em>) – Given operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The computing expression of logical and.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.common_ops.TaichiOperations.logical_or">
<span class="sig-name descname"><span class="pre">logical_or</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.common_ops.TaichiOperations.logical_or" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the new expression of computing logical or between self and a given operand.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Any</em>) – Given operand.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The computing expression of logical or.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-taichi.lang.exception">
<span id="taichi-lang-exception-module"></span><h2>taichi.lang.exception module<a class="headerlink" href="#module-taichi.lang.exception" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="taichi.lang.exception.InvalidOperationError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.exception.</span></span><span class="sig-name descname"><span class="pre">InvalidOperationError</span></span><a class="headerlink" href="#taichi.lang.exception.InvalidOperationError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="taichi.lang.exception.TaichiSyntaxError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.exception.</span></span><span class="sig-name descname"><span class="pre">TaichiSyntaxError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.exception.TaichiSyntaxError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

</div>
<div class="section" id="module-taichi.lang.expr">
<span id="taichi-lang-expr-module"></span><h2>taichi.lang.expr module<a class="headerlink" href="#module-taichi.lang.expr" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.expr.Expr">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.expr.</span></span><span class="sig-name descname"><span class="pre">Expr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.expr.Expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#taichi.lang.common_ops.TaichiOperations" title="taichi.lang.common_ops.TaichiOperations"><code class="xref py py-class docutils literal notranslate"><span class="pre">taichi.lang.common_ops.TaichiOperations</span></code></a></p>
<p>A Python-side Expr wrapper, whose member variable <cite>ptr</cite> is an instance of C++ Expr class. A C++ Expr object contains member variable <cite>expr</cite> which holds an instance of C++ Expression class.</p>
</dd></dl>

</div>
<div class="section" id="module-taichi.lang.impl">
<span id="taichi-lang-impl-module"></span><h2>taichi.lang.impl module<a class="headerlink" href="#module-taichi.lang.impl" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.impl.field">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.impl.</span></span><span class="sig-name descname"><span class="pre">field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">needs_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.impl.field" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a Taichi field</p>
<p>A Taichi field can be viewed as an abstract N-dimensional array, hiding away
the complexity of how its underlying <a class="reference internal" href="#taichi.lang.snode.SNode" title="taichi.lang.snode.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a> are
actually defined. The data in a Taichi field can be directly accessed by
a Taichi <a class="reference internal" href="#taichi.lang.kernel_impl.kernel" title="taichi.lang.kernel_impl.kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">kernel()</span></code></a>.</p>
<p>See also <a class="reference external" href="https://docs.taichi.graphics/docs/lang/articles/basic/field">https://docs.taichi.graphics/docs/lang/articles/basic/field</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<em>DataType</em>) – data type of the field.</p></li>
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – shape of the field</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – name of the field</p></li>
<li><p><strong>offset</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – offset of the field domain</p></li>
<li><p><strong>needs_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether this field participates in autodiff
and thus needs an adjoint field to store the gradients.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>The code below shows how a Taichi field can be declared and defined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Equivalently</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ti</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">ij</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.impl.grouped">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.impl.</span></span><span class="sig-name descname"><span class="pre">grouped</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.impl.grouped" title="Permalink to this definition">¶</a></dt>
<dd><p>Groups a list of independent loop indices into a <a class="reference internal" href="#taichi.lang.matrix.Vector" title="taichi.lang.matrix.Vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">Vector()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Any</em>) – does the grouping only if <cite>x</cite> is a <a class="reference internal" href="#module-taichi.lang.ndrange" title="taichi.lang.ndrange"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndrange</span></code></a>.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">ndrange</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">I</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.impl.insert_expr_stmt_if_ti_func">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.impl.</span></span><span class="sig-name descname"><span class="pre">insert_expr_stmt_if_ti_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.impl.insert_expr_stmt_if_ti_func" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is used only for real functions. It inserts a
FrontendExprStmt to the C++ AST to hold the function call if <cite>func</cite> is a
Taichi function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – The function to be called.</p></li>
<li><p><strong>args</strong> – The arguments of the function call.</p></li>
<li><p><strong>kwargs</strong> – The keyword arguments of the function call.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The return value of the function call if it’s a non-Taichi function.
Returns None if it’s a Taichi function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.impl.ndarray">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.impl.</span></span><span class="sig-name descname"><span class="pre">ndarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.impl.ndarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a Taichi ndarray with scalar elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<em>DataType</em>) – Data type of the ndarray.</p></li>
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple</em><em>[</em><em>int</em><em>]</em><em>]</em>) – Shape of the ndarray.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>The code below shows how a Taichi ndarray with scalar elements can be declared and defined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.impl.one">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.impl.</span></span><span class="sig-name descname"><span class="pre">one</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.impl.one" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill the input field with one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>DataType</em>) – The input field to fill.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output field, which keeps the shape but filled with one.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="taichi.lang.impl.root">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.impl.</span></span><span class="sig-name descname"><span class="pre">root</span></span><em class="property"> <span class="pre">=</span> <span class="pre">ti.root</span></em><a class="headerlink" href="#taichi.lang.impl.root" title="Permalink to this definition">¶</a></dt>
<dd><p>Root of the declared Taichi :func:<a href="#id1"><span class="problematic" id="id2">`</span></a>~taichi.lang.impl.field`s.</p>
<p>See also <a class="reference external" href="https://docs.taichi.graphics/docs/lang/articles/advanced/layout">https://docs.taichi.graphics/docs/lang/articles/advanced/layout</a></p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ti</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">ij</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">ij</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.impl.static">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.impl.</span></span><span class="sig-name descname"><span class="pre">static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">xs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.impl.static" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates a Taichi-scope expression at compile time.</p>
<p><cite>static()</cite> is what enables the so-called metaprogramming in Taichi. It is
in many ways similar to <code class="docutils literal notranslate"><span class="pre">constexpr</span></code> in C++11.</p>
<p>See also <a class="reference external" href="https://docs.taichi.graphics/docs/lang/articles/advanced/meta">https://docs.taichi.graphics/docs/lang/articles/advanced/meta</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Any</em>) – an expression to be evaluated</p></li>
<li><p><strong>*xs</strong> (<em>Any</em>) – for Python-ish swapping assignment</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>The most common usage of <cite>static()</cite> is for compile-time evaluation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">ti</span><span class="o">.</span><span class="n">static</span><span class="p">(</span><span class="n">FOO</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">do_a</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">do_b</span><span class="p">()</span>
</pre></div>
</div>
<p>Depending on the value of <code class="docutils literal notranslate"><span class="pre">FOO</span></code>, <code class="docutils literal notranslate"><span class="pre">run()</span></code> will be directly compiled
into either <code class="docutils literal notranslate"><span class="pre">do_a()</span></code> or <code class="docutils literal notranslate"><span class="pre">do_b()</span></code>. Thus there won’t be a runtime
condition check.</p>
<p>Another common usage is for compile-time loop unrolling:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">static</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The above is equivalent to:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.impl.zero">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.impl.</span></span><span class="sig-name descname"><span class="pre">zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.impl.zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill the input field with zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>DataType</em>) – The input field to fill.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output field, which keeps the shape but filled with zero.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-taichi.lang.kernel_arguments">
<span id="taichi-lang-kernel-arguments-module"></span><h2>taichi.lang.kernel_arguments module<a class="headerlink" href="#module-taichi.lang.kernel_arguments" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.kernel_arguments.ArgAnyArray">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.kernel_arguments.</span></span><span class="sig-name descname"><span class="pre">ArgAnyArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Layout.AOS</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.kernel_arguments.ArgAnyArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Type annotation for arbitrary arrays, including external arrays and Taichi ndarrays.</p>
<p>For external arrays, we can treat it as a Taichi field with Vector or Matrix elements by specifying element shape and layout.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element_shape</strong> (<em>Tuple</em><em>[</em><em>Int</em><em>]</em><em>, </em><em>optional</em>) – () if scalar elements (default), (n) if vector elements, and (n, m) if matrix elements.</p></li>
<li><p><strong>layout</strong> (<a class="reference internal" href="#taichi.lang.Layout" title="taichi.lang.Layout"><em>Layout</em></a><em>, </em><em>optional</em>) – Memory layout, AOS by default.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.kernel_arguments.ArgExtArray">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.kernel_arguments.</span></span><span class="sig-name descname"><span class="pre">ArgExtArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.kernel_arguments.ArgExtArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Type annotation for external arrays.</p>
<p>External array is formally defined as the data from other Python frameworks.
For now, Taichi supports numpy and pytorch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dim</strong> (<em>int</em><em>, </em><em>optional</em>) – must be 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.kernel_arguments.Template">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.kernel_arguments.</span></span><span class="sig-name descname"><span class="pre">Template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.kernel_arguments.Template" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Type annotation for template kernel parameter.</p>
<p>See also <a class="reference external" href="https://docs.taichi.graphics/docs/lang/articles/advanced/meta">https://docs.taichi.graphics/docs/lang/articles/advanced/meta</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<em>Any</em>) – unused</p></li>
<li><p><strong>dim</strong> (<em>Any</em>) – unused</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="taichi.lang.kernel_arguments.any_arr">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.kernel_arguments.</span></span><span class="sig-name descname"><span class="pre">any_arr</span></span><a class="headerlink" href="#taichi.lang.kernel_arguments.any_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#taichi.lang.kernel_arguments.ArgAnyArray" title="taichi.lang.kernel_arguments.ArgAnyArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArgAnyArray</span></code></a>.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">to_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">any_arr</span><span class="p">(),</span> <span class="n">y</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">any_arr</span><span class="p">()):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f64</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">...</span> <span class="c1"># calculate y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># `x` will be filled with `y`&#39;s data.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="taichi.lang.kernel_arguments.ext_arr">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.kernel_arguments.</span></span><span class="sig-name descname"><span class="pre">ext_arr</span></span><a class="headerlink" href="#taichi.lang.kernel_arguments.ext_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#taichi.lang.kernel_arguments.ArgExtArray" title="taichi.lang.kernel_arguments.ArgExtArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArgExtArray</span></code></a>.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">to_numpy</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">ext_arr</span><span class="p">()):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to_numpy</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>  <span class="c1"># `arr` will be filled with `x`&#39;s data.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="taichi.lang.kernel_arguments.template">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.kernel_arguments.</span></span><span class="sig-name descname"><span class="pre">template</span></span><a class="headerlink" href="#taichi.lang.kernel_arguments.template" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#taichi.lang.kernel_arguments.Template" title="taichi.lang.kernel_arguments.Template"><code class="xref py py-class docutils literal notranslate"><span class="pre">Template</span></code></a>.</p>
</dd></dl>

</div>
<div class="section" id="module-taichi.lang.kernel_impl">
<span id="taichi-lang-kernel-impl-module"></span><h2>taichi.lang.kernel_impl module<a class="headerlink" href="#module-taichi.lang.kernel_impl" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="taichi.lang.kernel_impl.KernelArgError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.kernel_impl.</span></span><span class="sig-name descname"><span class="pre">KernelArgError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">needed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">provided</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.kernel_impl.KernelArgError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="taichi.lang.kernel_impl.KernelDefError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.kernel_impl.</span></span><span class="sig-name descname"><span class="pre">KernelDefError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.kernel_impl.KernelDefError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.kernel_impl.data_oriented">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.kernel_impl.</span></span><span class="sig-name descname"><span class="pre">data_oriented</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.kernel_impl.data_oriented" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks a class as Taichi compatible.</p>
<p>To allow for modularized code, Taichi provides this decorator so that
Taichi kernels can be defined inside a class.</p>
<p>See also <a class="reference external" href="https://docs.taichi.graphics/docs/lang/articles/advanced/odop">https://docs.taichi.graphics/docs/lang/articles/advanced/odop</a></p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">data_oriented</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">TiArray</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">inc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">TiArray</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">inc</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cls</strong> (<em>Class</em>) – the class to be decorated</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The decorated class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.kernel_impl.func">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.kernel_impl.</span></span><span class="sig-name descname"><span class="pre">func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.kernel_impl.func" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks a function as callable in Taichi-scope.</p>
<p>This decorator transforms a Python function into a Taichi one. Taichi
will JIT compile it into native instructions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fn</strong> (<em>Callable</em>) – The Python function to be decorated</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The decorated function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">func</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">foo</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>  <span class="c1"># 42</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.kernel_impl.kernel">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.kernel_impl.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.kernel_impl.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks a function as a Taichi kernel.</p>
<p>A Taichi kernel is a function written in Python, and gets JIT compiled by
Taichi into native CPU/GPU instructions (e.g. a series of CUDA kernels).
The top-level <code class="docutils literal notranslate"><span class="pre">for</span></code> loops are automatically parallelized, and distributed
to either a CPU thread pool or massively parallel GPUs.</p>
<p>Kernel’s gradient kernel would be generated automatically by the AutoDiff system.</p>
<p>See also <a class="reference external" href="https://docs.taichi.graphics/docs/lang/articles/basic/syntax#kernels">https://docs.taichi.graphics/docs/lang/articles/basic/syntax#kernels</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fn</strong> (<em>Callable</em>) – the Python function to be decorated</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The decorated function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Assigns all the elements of `x` in parallel.</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.kernel_impl.pyfunc">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.kernel_impl.</span></span><span class="sig-name descname"><span class="pre">pyfunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.kernel_impl.pyfunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks a function as callable in both Taichi and Python scopes.</p>
<p>When called inside the Taichi scope, Taichi will JIT compile it into
native instructions. Otherwise it will be invoked directly as a
Python function.</p>
<p>See also <a class="reference internal" href="#taichi.lang.kernel_impl.func" title="taichi.lang.kernel_impl.func"><code class="xref py py-func docutils literal notranslate"><span class="pre">func()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fn</strong> (<em>Callable</em>) – The Python function to be decorated</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The decorated function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-taichi.lang.linalg">
<span id="taichi-lang-linalg-module"></span><h2>taichi.lang.linalg module<a class="headerlink" href="#module-taichi.lang.linalg" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.linalg.eig2x2">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.linalg.</span></span><span class="sig-name descname"><span class="pre">eig2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.linalg.eig2x2" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the eigenvalues and right eigenvectors (Av=lambda v) of a 2x2 real matrix.</p>
<p>Mathematical concept refers to <a class="reference external" href="https://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix">https://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ti.Matrix</em><em>(</em><em>2</em><em>, </em><em>2</em><em>)</em>) – input 2x2 matrix <cite>A</cite>.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em>) – date type of elements in matrix <cite>A</cite>, typically accepts ti.f32 or ti.f64.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The eigenvalues in complex form. Each row stores one eigenvalue. The first number of the eigenvalue represents the real part and the second number represents the imaginary part.
eigenvectors: (ti.Matrix(4, 2)): The eigenvectors in complex form. Each column stores one eigenvector. Each eigenvector consists of 2 entries, each of which is represented by two numbers for its real part and imaginary part.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>eigenvalues (ti.Matrix(2, 2))</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.linalg.polar_decompose">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.linalg.</span></span><span class="sig-name descname"><span class="pre">polar_decompose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.linalg.polar_decompose" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform polar decomposition (A=UP) for arbitrary size matrix.</p>
<p>Mathematical concept refers to <a class="reference external" href="https://en.wikipedia.org/wiki/Polar_decomposition">https://en.wikipedia.org/wiki/Polar_decomposition</a>.
2D implementation refers to <a class="reference internal" href="#taichi.lang.linalg.polar_decompose2d" title="taichi.lang.linalg.polar_decompose2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.linalg.polar_decompose2d()</span></code></a>.
3D implementation refers to <a class="reference internal" href="#taichi.lang.linalg.polar_decompose3d" title="taichi.lang.linalg.polar_decompose3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.linalg.polar_decompose3d()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ti.Matrix</em><em>(</em><em>n</em><em>, </em><em>n</em><em>)</em>) – input nxn matrix <cite>A</cite>.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em>) – date type of elements in matrix <cite>A</cite>, typically accepts ti.f32 or ti.f64.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Decomposed nxn matrices <cite>U</cite> and <cite>P</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.linalg.polar_decompose2d">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.linalg.</span></span><span class="sig-name descname"><span class="pre">polar_decompose2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.linalg.polar_decompose2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform polar decomposition (A=UP) for 2x2 matrix.</p>
<p>Mathematical concept refers to <a class="reference external" href="https://en.wikipedia.org/wiki/Polar_decomposition">https://en.wikipedia.org/wiki/Polar_decomposition</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ti.Matrix</em><em>(</em><em>2</em><em>, </em><em>2</em><em>)</em>) – input 2x2 matrix <cite>A</cite>.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em>) – date type of elements in matrix <cite>A</cite>, typically accepts ti.f32 or ti.f64.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Decomposed 2x2 matrices <cite>U</cite> and <cite>P</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.linalg.polar_decompose3d">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.linalg.</span></span><span class="sig-name descname"><span class="pre">polar_decompose3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.linalg.polar_decompose3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform polar decomposition (A=UP) for 3x3 matrix.</p>
<p>Mathematical concept refers to <a class="reference external" href="https://en.wikipedia.org/wiki/Polar_decomposition">https://en.wikipedia.org/wiki/Polar_decomposition</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ti.Matrix</em><em>(</em><em>3</em><em>, </em><em>3</em><em>)</em>) – input 3x3 matrix <cite>A</cite>.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em>) – date type of elements in matrix <cite>A</cite>, typically accepts ti.f32 or ti.f64.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Decomposed 3x3 matrices <cite>U</cite> and <cite>P</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.linalg.svd">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.linalg.</span></span><span class="sig-name descname"><span class="pre">svd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.linalg.svd" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform singular value decomposition (A=USV^T) for arbitrary size matrix.</p>
<p>Mathematical concept refers to <a class="reference external" href="https://en.wikipedia.org/wiki/Singular_value_decomposition">https://en.wikipedia.org/wiki/Singular_value_decomposition</a>.
2D implementation refers to <a class="reference internal" href="#taichi.lang.linalg.svd2d" title="taichi.lang.linalg.svd2d"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.linalg.svd2d()</span></code></a>.
3D implementation refers to <a class="reference internal" href="#taichi.lang.linalg.svd3d" title="taichi.lang.linalg.svd3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.linalg.svd3d()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ti.Matrix</em><em>(</em><em>n</em><em>, </em><em>n</em><em>)</em>) – input nxn matrix <cite>A</cite>.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em>) – date type of elements in matrix <cite>A</cite>, typically accepts ti.f32 or ti.f64.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Decomposed nxn matrices <cite>U</cite>, ‘S’ and <cite>V</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.linalg.svd2d">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.linalg.</span></span><span class="sig-name descname"><span class="pre">svd2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.linalg.svd2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform singular value decomposition (A=USV^T) for 2x2 matrix.</p>
<p>Mathematical concept refers to <a class="reference external" href="https://en.wikipedia.org/wiki/Singular_value_decomposition">https://en.wikipedia.org/wiki/Singular_value_decomposition</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ti.Matrix</em><em>(</em><em>2</em><em>, </em><em>2</em><em>)</em>) – input 2x2 matrix <cite>A</cite>.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em>) – date type of elements in matrix <cite>A</cite>, typically accepts ti.f32 or ti.f64.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Decomposed 2x2 matrices <cite>U</cite>, ‘S’ and <cite>V</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.linalg.svd3d">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.linalg.</span></span><span class="sig-name descname"><span class="pre">svd3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.linalg.svd3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform singular value decomposition (A=USV^T) for 3x3 matrix.</p>
<p>Mathematical concept refers to <a class="reference external" href="https://en.wikipedia.org/wiki/Singular_value_decomposition">https://en.wikipedia.org/wiki/Singular_value_decomposition</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ti.Matrix</em><em>(</em><em>3</em><em>, </em><em>3</em><em>)</em>) – input 3x3 matrix <cite>A</cite>.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em>) – date type of elements in matrix <cite>A</cite>, typically accepts ti.f32 or ti.f64.</p></li>
<li><p><strong>iters</strong> (<em>int</em>) – iteration number to control algorithm precision.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Decomposed 3x3 matrices <cite>U</cite>, ‘S’ and <cite>V</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.linalg.sym_eig2x2">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.linalg.</span></span><span class="sig-name descname"><span class="pre">sym_eig2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.linalg.sym_eig2x2" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the eigenvalues and right eigenvectors (Av=lambda v) of a 2x2 real symmetric matrix.</p>
<p>Mathematical concept refers to <a class="reference external" href="https://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix">https://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ti.Matrix</em><em>(</em><em>2</em><em>, </em><em>2</em><em>)</em>) – input 2x2 symmetric matrix <cite>A</cite>.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em>) – date type of elements in matrix <cite>A</cite>, typically accepts ti.f32 or ti.f64.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The eigenvalues. Each entry store one eigen value.
eigenvectors (ti.Matrix(2, 2)): The eigenvectors. Each column stores one eigenvector.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>eigenvalues (ti.Vector(2))</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-taichi.lang.matrix">
<span id="taichi-lang-matrix-module"></span><h2>taichi.lang.matrix module<a class="headerlink" href="#module-taichi.lang.matrix" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.matrix.</span></span><span class="sig-name descname"><span class="pre">Matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Layout.AOS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">needs_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_local_tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#taichi.lang.common_ops.TaichiOperations" title="taichi.lang.common_ops.TaichiOperations"><code class="xref py py-class docutils literal notranslate"><span class="pre">taichi.lang.common_ops.TaichiOperations</span></code></a></p>
<p>The matrix class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – the first dimension of a matrix.</p></li>
<li><p><strong>m</strong> (<em>int</em>) – the second dimension of a matrix.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em>) – the elmement data type.</p></li>
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple of int</em><em>]</em><em>, </em><em>optional</em>) – the shape of a matrix field.</p></li>
<li><p><strong>offset</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple of int</em><em>]</em><em>, </em><em>optional</em>) – The coordinate offset of all elements in a field.</p></li>
<li><p><strong>empty</strong> (<em>Bool</em><em>, </em><em>deprecated</em>) – True if the matrix is empty, False otherwise.</p></li>
<li><p><strong>layout</strong> (<a class="reference internal" href="#taichi.lang.Layout" title="taichi.lang.Layout"><em>Layout</em></a><em>, </em><em>optional</em>) – The filed layout (Layout.AOS or Layout.SOA).</p></li>
<li><p><strong>needs_grad</strong> (<em>Bool</em><em>, </em><em>optional</em>) – True if used in auto diff, False otherwise.</p></li>
<li><p><strong>keep_raw</strong> (<em>Bool</em><em>, </em><em>optional</em>) – Keep the contents in <cite>n</cite> as is.</p></li>
<li><p><strong>rows</strong> (<em>List</em><em>, </em><em>deprecated</em>) – construct matrix rows.</p></li>
<li><p><strong>cols</strong> (<em>List</em><em>, </em><em>deprecated</em>) – construct matrix columns.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.all">
<span class="sig-name descname"><span class="pre">all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.all" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether all element not equal zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if all elements are not equal zero, False otherwise.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.any">
<span class="sig-name descname"><span class="pre">any</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.any" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether any element not equal zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if any element is not equal zero, False otherwise.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.cast">
<span class="sig-name descname"><span class="pre">cast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.cast" title="Permalink to this definition">¶</a></dt>
<dd><p>Cast the matrix element data type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dtype</strong> (<em>DataType</em>) – the data type of the casted matrix element.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A new matrix with each element’s type is dtype.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.cols">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">cols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.cols" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Matrix instance by concactinating Vectors/lists column by column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cols</strong> (<em>List</em>) – A list of Vector (1-D Matrix) or a list of list.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance filled with the Vectors/lists column by column.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.cross">
<span class="sig-name descname"><span class="pre">cross</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.cross" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the cross product with the input Vector (1-D Matrix).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>) – The input Vector (1-D Matrix) to perform the cross product.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The cross product result (1-D Matrix) of the two Vectors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.determinant">
<span class="sig-name descname"><span class="pre">determinant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.determinant" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the determinant of a matrix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The matrix dimension should be less than or equal to 4.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The determinant of a matrix.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – Determinants of matrices with sizes &gt;= 5 are not supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.diag">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.diag" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a diagonal square matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<em>int</em>) – the dimension of a square matrix.</p></li>
<li><p><strong>val</strong> (<em>TypeVar</em>) – the diagonal elment value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The constructed diagonal square matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.dot">
<span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the dot product with the input Vector (1-D Matrix).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>) – The input Vector (1-D Matrix) to perform the dot product.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The dot product result (scalar) of the two Vectors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.empty">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the matrix and fill None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The number of the row of the matrix.</p></li>
<li><p><strong>m</strong> (<em>int</em>) – The number of the column of the matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance filled with None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.field">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">needs_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Layout.AOS</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.field" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a data container to hold all elements of the Matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The desired number of rows of the Matrix.</p></li>
<li><p><strong>m</strong> (<em>int</em>) – The desired number of columns of the Matrix.</p></li>
<li><p><strong>dtype</strong> (<em>DataType</em><em>, </em><em>optional</em>) – The desired data type of the Matrix.</p></li>
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple of int</em><em>]</em><em>, </em><em>optional</em>) – The desired shape of the Matrix.</p></li>
<li><p><strong>name</strong> (<em>string</em><em>, </em><em>optional</em>) – The custom name of the field.</p></li>
<li><p><strong>offset</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple of int</em><em>]</em><em>, </em><em>optional</em>) – The coordinate offset of all elements in a field.</p></li>
<li><p><strong>needs_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the Matrix need gradients.</p></li>
<li><p><strong>layout</strong> (<a class="reference internal" href="#taichi.lang.Layout" title="taichi.lang.Layout"><em>Layout</em></a><em>, </em><em>optional</em>) – The field layout, i.e., Array Of Structure (AOS) or Structure Of Array (SOA).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance serves as the data container.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.fill">
<span class="sig-name descname"><span class="pre">fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.fill" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills the matrix with a specific value in Taichi scope.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>val</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Value to fill.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.identity">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.identity" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an identity Matrix with shape (n, n).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> (<em>DataType</em>) – The desired data type.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The number of rows/columns.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A n x n identity <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.inverse">
<span class="sig-name descname"><span class="pre">inverse</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse of a matrix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The matrix dimension should be less than or equal to 4.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The inverse of a matrix.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – Inversions of matrices with sizes &gt;= 5 are not supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.inversed">
<span class="sig-name descname"><span class="pre">inversed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.inversed" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse of a matrix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The matrix dimension should be less than or equal to 4.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The inverse of a matrix.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – Inversions of matrices with sizes &gt;= 5 are not supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.max">
<span class="sig-name descname"><span class="pre">max</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.max" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximum element value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.min">
<span class="sig-name descname"><span class="pre">min</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.min" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the minumum element value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the square root of the sum of the absolute squares of its elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eps</strong> (<em>Number</em>) – a safe-guard value for sqrt, usually 0.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">a</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="c1"># sqrt(3*3 + 4*4 + 0) = 5</span>
<span class="c1"># `a.norm(eps)` is equivalent to `ti.sqrt(a.dot(a) + eps).`</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The square root of the sum of the absolute squares of its elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.norm_inv">
<span class="sig-name descname"><span class="pre">norm_inv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.norm_inv" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the inverse of the matrix/vector <cite>norm</cite>. For <cite>norm</cite>: please see <a class="reference internal" href="#taichi.lang.matrix.Matrix.norm" title="taichi.lang.matrix.Matrix.norm"><code class="xref py py-func docutils literal notranslate"><span class="pre">norm()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eps</strong> (<em>Number</em>) – a safe-guard value for sqrt, usually 0.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The inverse of the matrix/vector <cite>norm</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.norm_sqr">
<span class="sig-name descname"><span class="pre">norm_sqr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.norm_sqr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sum of the absolute squares of its elements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.normalized">
<span class="sig-name descname"><span class="pre">normalized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.normalized" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize a vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eps</strong> (<em>Number</em>) – a safe-guard value for sqrt, usually 0.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">a</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span> <span class="c1"># [3 / 5, 4 / 5]</span>
<span class="c1"># `a.normalized()` is equivalent to `a / a.norm()`.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only vector normalization is supported.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.one">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">one</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.one" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Matrix filled with ones.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> (<em>DataType</em>) – The desired data type.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The first dimension (row) of the matrix.</p></li>
<li><p><strong>m</strong> (<em>int</em><em>, </em><em>optional</em>) – The second dimension (column) of the matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance filled with ones.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.outer_product">
<span class="sig-name descname"><span class="pre">outer_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.outer_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the outer product with the input Vector (1-D Matrix).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>) – The input Vector (1-D Matrix) to perform the outer product.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The outer product result (Matrix) of the two Vectors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.rows">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rows</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Matrix instance by concactinating Vectors/lists row by row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rows</strong> (<em>List</em>) – A list of Vector (1-D Matrix) or a list of list.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance filled with the Vectors/lists row by row.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.sum">
<span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sum of all elements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.to_numpy">
<span class="sig-name descname"><span class="pre">to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.to_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the Matrix to a numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>keep_dims</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to keep the dimension after conversion.
When keep_dims=False, the resulting numpy array should skip the matrix dims with size 1.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result numpy array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.trace">
<span class="sig-name descname"><span class="pre">trace</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.trace" title="Permalink to this definition">¶</a></dt>
<dd><p>The sum of a matrix diagonal elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The sum of a matrix diagonal elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.transpose">
<span class="sig-name descname"><span class="pre">transpose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the transpose of a matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Get the transpose of a matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.unit">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an unit Vector (1-D matrix) i.e., a vector with only one entry filled with one and all other entries zeros.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The length of the vector.</p></li>
<li><p><strong>i</strong> (<em>int</em>) – The index of the entry that will be filled with one.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em><em>, </em><em>optional</em>) – The desired data type.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An 1-D unit <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.var">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.var" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.w">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">w</span></span><a class="headerlink" href="#taichi.lang.matrix.Matrix.w" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the fourth element of a matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.with_entries">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">with_entries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entries</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.with_entries" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Matrix instance by giving all entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Number of rows of the matrix.</p></li>
<li><p><strong>m</strong> (<em>int</em>) – Number of columns of the matrix.</p></li>
<li><p><strong>entries</strong> (<em>List</em><em>[</em><em>Any</em><em>]</em>) – Given entries.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance filled with given entries.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix">Matrix</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.x">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#taichi.lang.matrix.Matrix.x" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the first element of a matrix.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.y">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">y</span></span><a class="headerlink" href="#taichi.lang.matrix.Matrix.y" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the second element of a matrix.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.z">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">z</span></span><a class="headerlink" href="#taichi.lang.matrix.Matrix.z" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the third element of a matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.Matrix.zero">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Matrix.zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Matrix filled with zeros.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> (<em>DataType</em>) – The desired data type.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The first dimension (row) of the matrix.</p></li>
<li><p><strong>m</strong> (<em>int</em><em>, </em><em>optional</em>) – The second dimension (column) of the matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance filled with zeros.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.matrix.MatrixField">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.matrix.</span></span><span class="sig-name descname"><span class="pre">MatrixField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.MatrixField" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#taichi.lang.Field" title="taichi.lang.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">taichi.lang.field.Field</span></code></a></p>
<p>Taichi matrix field with SNode implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vars</strong> (<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><em>Expr</em></a>) – Field members.</p></li>
<li><p><strong>n</strong> (<em>Int</em>) – Number of rows.</p></li>
<li><p><strong>m</strong> (<em>Int</em>) – Number of columns.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.MatrixField.fill">
<span class="sig-name descname"><span class="pre">fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.MatrixField.fill" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills <cite>self</cite> with specific values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>val</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>List</em><em>, </em><em>Tuple</em><em>, </em><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><em>Matrix</em></a><em>]</em>) – Values to fill, which should have dimension consistent with <cite>self</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.MatrixField.from_numpy">
<span class="sig-name descname"><span class="pre">from_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.MatrixField.from_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads all elements from a numpy array.</p>
<p>The shape of the numpy array needs to be the same as <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>numpy.ndarray</em>) – The source numpy array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.MatrixField.get_scalar_field">
<span class="sig-name descname"><span class="pre">get_scalar_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.MatrixField.get_scalar_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a ScalarField using a specific field member. Only used for quant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>indices</strong> (<em>Tuple</em><em>[</em><em>Int</em><em>]</em>) – Specified indices of the field member.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result ScalarField.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.ScalarField" title="taichi.lang.ScalarField">ScalarField</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.MatrixField.to_numpy">
<span class="sig-name descname"><span class="pre">to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.MatrixField.to_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts <cite>self</cite> to a numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keep_dims</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to keep the dimension after conversion.
When keep_dims=True, on an n-D matrix field, the numpy array always has n+2 dims, even for 1x1, 1xn, nx1 matrix fields.
When keep_dims=False, the resulting numpy array should skip the matrix dims with size 1.
For example, a 4x1 or 1x4 matrix field with 5x6x7 elements results in an array of shape 5x6x7x4.</p></li>
<li><p><strong>as_vector</strong> (<em>bool</em><em>, </em><em>deprecated</em>) – Whether to make the returned numpy array as a vector, i.e., with shape (n,) rather than (n, 1).
Note that this argument has been deprecated.
More discussion about <cite>as_vector</cite>: <a class="reference external" href="https://github.com/taichi-dev/taichi/pull/1046#issuecomment-633548858">https://github.com/taichi-dev/taichi/pull/1046#issuecomment-633548858</a>.</p></li>
<li><p><strong>dtype</strong> (<em>DataType</em><em>, </em><em>optional</em>) – The desired data type of returned numpy array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result numpy array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.matrix.MatrixField.to_torch">
<span class="sig-name descname"><span class="pre">to_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.MatrixField.to_torch" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts <cite>self</cite> to a torch tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The desired device of returned tensor.</p></li>
<li><p><strong>keep_dims</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to keep the dimension after conversion.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">to_numpy()</span></code> for more detailed explanation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result torch tensor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.matrix.Vector">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.matrix.</span></span><span class="sig-name descname"><span class="pre">Vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.matrix.Vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a <cite>Vector</cite> instance i.e. 1-D Matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The desired number of entries of the Vector.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em><em>, </em><em>optional</em>) – The desired data type of the Vector.</p></li>
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple of int</em><em>]</em><em>, </em><em>optional</em>) – The shape of the Vector.</p></li>
<li><p><strong>offset</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple of int</em><em>]</em><em>, </em><em>optional</em>) – The coordinate offset of all elements in a field.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Vector instance (1-D <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-taichi.lang.meta">
<span id="taichi-lang-meta-module"></span><h2>taichi.lang.meta module<a class="headerlink" href="#module-taichi.lang.meta" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-taichi.lang.ndrange">
<span id="taichi-lang-ndrange-module"></span><h2>taichi.lang.ndrange module<a class="headerlink" href="#module-taichi.lang.ndrange" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-taichi.lang.ops">
<span id="taichi-lang-ops-module"></span><h2>taichi.lang.ops module<a class="headerlink" href="#module-taichi.lang.ops" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.abs">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.abs" title="Permalink to this definition">¶</a></dt>
<dd><p>The absolute value function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The absolute value of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.acos">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">acos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.acos" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverses function of cosine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements in [-1,1].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The inverses function of cosine of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.add">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.add" title="Permalink to this definition">¶</a></dt>
<dd><p>The add function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sum of <cite>a</cite> and <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.asin">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">asin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.asin" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverses function of sine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements in [-1,1].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The inverses function of sine of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.atan2">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">atan2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.atan2" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverses of the tangent function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements not equal to zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The inverses function of tangent of <cite>b/a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.bit_and">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">bit_and</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.bit_and" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bitwise-and</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS bitwise-and with RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.bit_not">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">bit_not</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.bit_not" title="Permalink to this definition">¶</a></dt>
<dd><p>The bit not function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Bitwise not of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.bit_or">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">bit_or</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.bit_or" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes bitwise-or</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS bitwise-or with RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.bit_sar">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">bit_sar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.bit_sar" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bitwise shift right</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS &gt;&gt; RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.bit_shl">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">bit_shl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.bit_shl" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bitwise shift left</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS &lt;&lt; RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.bit_shr">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">bit_shr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.bit_shr" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bitwise shift right (in taichi scope)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS &gt;&gt; RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.bit_xor">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">bit_xor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.bit_xor" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bitwise-xor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS bitwise-xor with RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.ceil">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">ceil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.ceil" title="Permalink to this definition">¶</a></dt>
<dd><p>The ceil function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The least integer greater than or equal to <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.cmp_eq">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">cmp_eq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.cmp_eq" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two values (equal to)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if LHS is equal to RHS, False otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.cmp_ge">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">cmp_ge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.cmp_ge" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two values (greater than or equal to)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if LHS is greater than or equal to RHS, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.cmp_gt">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">cmp_gt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.cmp_gt" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two values (greater than)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if LHS is strictly larger than RHS, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.cmp_le">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">cmp_le</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.cmp_le" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two values (less than or equal to)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if LHS is smaller than or equal to RHS, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.cmp_lt">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">cmp_lt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.cmp_lt" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two values (less than)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if LHS is strictly smaller than RHS, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.cmp_ne">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">cmp_ne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.cmp_ne" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two values (not equal to)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if LHS is not equal to RHS, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.cos">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">cos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.cos" title="Permalink to this definition">¶</a></dt>
<dd><p>The cosine function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cosine of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.exp">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>The exp function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>e</cite> to the <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.floor">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">floor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.floor" title="Permalink to this definition">¶</a></dt>
<dd><p>The floor function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The greatest integer less than or equal to <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.floordiv">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">floordiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.floordiv" title="Permalink to this definition">¶</a></dt>
<dd><p>The floor division function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements not equal to zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The floor function of <cite>a</cite> divided by <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.get_addr">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">get_addr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.get_addr" title="Permalink to this definition">¶</a></dt>
<dd><p>Query the memory address (on CUDA/x64) of field <cite>f</cite> at index <cite>indices</cite>.</p>
<p>Currently, this function can only be called inside a taichi kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>Union</em><em>[</em><em>ti.field</em><em>, </em><em>ti.Vector.field</em><em>, </em><em>ti.Matrix.field</em><em>]</em>) – Input taichi field for memory address query.</p></li>
<li><p><strong>indices</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>ti.Vector</em><em>(</em><em>)</em><em>]</em>) – The specified field indices of the query.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The memory address of <cite>f[indices]</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ti.u64</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.log">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.log" title="Permalink to this definition">¶</a></dt>
<dd><p>The natural logarithm function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements greater than zero.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The natural logarithm of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.logical_and">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">logical_and</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.logical_and" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bitwise-and</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS bitwise-and with RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.logical_not">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">logical_not</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.logical_not" title="Permalink to this definition">¶</a></dt>
<dd><p>The logical not function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>1</cite> iff <cite>a=0</cite>, otherwise <cite>0</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.logical_or">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">logical_or</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.logical_or" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes bitwise-or</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS bitwise-or with RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.max">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.max" title="Permalink to this definition">¶</a></dt>
<dd><p>The maxnimum function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The maxnimum of <cite>a</cite> and <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.min">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.min" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The minimum of <cite>a</cite> and <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.mod">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.mod" title="Permalink to this definition">¶</a></dt>
<dd><p>The remainder function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements not equal to zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The remainder of <cite>a</cite> divided by <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.mul">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">mul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.mul" title="Permalink to this definition">¶</a></dt>
<dd><p>The multiply function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>a</cite> multiplied by <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.neg">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">neg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.neg" title="Permalink to this definition">¶</a></dt>
<dd><p>The negate function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The negative value of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.pow">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">pow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.pow" title="Permalink to this definition">¶</a></dt>
<dd><p>The power function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>a</cite> to the <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.random">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">random</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">dtype=&lt;class</span> <span class="pre">'float'&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.random" title="Permalink to this definition">¶</a></dt>
<dd><p>The random function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dtype</strong> (<em>DataType</em>) – Type of the random variable.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A random variable whose type is <cite>dtype</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.raw_div">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">raw_div</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.raw_div" title="Permalink to this definition">¶</a></dt>
<dd><p>Raw_div function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements not equal to zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If <cite>a</cite> is a <cite>int</cite> and <cite>b</cite> is a <cite>int</cite>, then return <cite>a//b</cite>. Else return <cite>a/b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.raw_mod">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">raw_mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.raw_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Raw_mod function. Both <cite>a</cite> and <cite>b</cite> can be <cite>float</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements not equal to zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The remainder of <cite>a</cite> divided by <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.rescale_index">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">rescale_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.rescale_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Rescales the index ‘I’ of field ‘a’ the match the shape of field ‘b’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>ti.field</em><em>(</em><em>)</em><em>, </em><em>ti.Vector.field</em><em>, </em><em>ti.Matrix.field</em><em>(</em><em>)</em>) – input taichi field</p></li>
<li><p><strong>b</strong> (<em>ti.field</em><em>(</em><em>)</em><em>, </em><em>ti.Vector.field</em><em>, </em><em>ti.Matrix.field</em><em>(</em><em>)</em>) – output taichi field</p></li>
<li><p><strong>I</strong> (<em>ti.Vector</em><em>(</em><em>)</em>) – grouped loop index</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ib</strong> – rescaled grouped loop index</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ti.Vector()</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.rsqrt">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">rsqrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.rsqrt" title="Permalink to this definition">¶</a></dt>
<dd><p>The reciprocal of the square root function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The reciprocal of <cite>sqrt(a)</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.sin">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">sin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.sin" title="Permalink to this definition">¶</a></dt>
<dd><p>The sine function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Sine of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.sqrt">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">sqrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.sqrt" title="Permalink to this definition">¶</a></dt>
<dd><p>The square root function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements not less than zero.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>x</cite> such that <cite>x&gt;=0</cite> and <cite>x^2=a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.sub">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">sub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.sub" title="Permalink to this definition">¶</a></dt>
<dd><p>The sub function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>a</cite> subtract <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.tan">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">tan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.tan" title="Permalink to this definition">¶</a></dt>
<dd><p>The tangent function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tangent of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.tanh">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">tanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.tanh" title="Permalink to this definition">¶</a></dt>
<dd><p>The hyperbolic tangent function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>(e**x - e**(-x)) / (e**x + e**(-x))</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ops.truediv">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.ops.</span></span><span class="sig-name descname"><span class="pre">truediv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ops.truediv" title="Permalink to this definition">¶</a></dt>
<dd><p>True division function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements not equal to zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The true value of <cite>a</cite> divided by <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-taichi.lang.quant_impl">
<span id="taichi-lang-quant-impl-module"></span><h2>taichi.lang.quant_impl module<a class="headerlink" href="#module-taichi.lang.quant_impl" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.quant_impl.Quant">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.quant_impl.</span></span><span class="sig-name descname"><span class="pre">Quant</span></span><a class="headerlink" href="#taichi.lang.quant_impl.Quant" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generator of quantized types.</p>
<p>For more details, read <a class="reference external" href="https://yuanming.taichi.graphics/publication/2021-quantaichi/quantaichi.pdf">https://yuanming.taichi.graphics/publication/2021-quantaichi/quantaichi.pdf</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.quant_impl.Quant.fixed">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">fixed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.quant_impl.Quant.fixed" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a quantized type for fixed-point real numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frac</strong> (<em>int</em>) – Number of bits.</p></li>
<li><p><strong>signed</strong> (<em>bool</em>) – Signed or unsigned.</p></li>
<li><p><strong>range</strong> (<em>float</em>) – Range of the number.</p></li>
<li><p><strong>compute</strong> (<em>DataType</em>) – Type for computation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The specified type.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.quant_impl.Quant.float">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.quant_impl.Quant.float" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a quantized type for floating-point real numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp</strong> (<em>int</em>) – Number of exponent bits.</p></li>
<li><p><strong>frac</strong> (<em>int</em>) – Number of fraction bits.</p></li>
<li><p><strong>signed</strong> (<em>bool</em>) – Signed or unsigned.</p></li>
<li><p><strong>compute</strong> (<em>DataType</em>) – Type for computation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The specified type.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.quant_impl.Quant.int">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.quant_impl.Quant.int" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a quantized type for integers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bits</strong> (<em>int</em>) – Number of bits.</p></li>
<li><p><strong>signed</strong> (<em>bool</em>) – Signed or unsigned.</p></li>
<li><p><strong>compute</strong> (<em>DataType</em>) – Type for computation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The specified type.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="taichi.lang.quant_impl.quant">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.quant_impl.</span></span><span class="sig-name descname"><span class="pre">quant</span></span><a class="headerlink" href="#taichi.lang.quant_impl.quant" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#taichi.lang.quant_impl.Quant" title="taichi.lang.quant_impl.Quant"><code class="xref py py-class docutils literal notranslate"><span class="pre">taichi.lang.quant_impl.Quant</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-taichi.lang.random">
<span id="taichi-lang-random-module"></span><h2>taichi.lang.random module<a class="headerlink" href="#module-taichi.lang.random" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.random.randn">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.random.</span></span><span class="sig-name descname"><span class="pre">randn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.random.randn" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a random number from standard normal distribution
using the Box-Muller transform.</p>
</dd></dl>

</div>
<div class="section" id="module-taichi.lang.runtime_ops">
<span id="taichi-lang-runtime-ops-module"></span><h2>taichi.lang.runtime_ops module<a class="headerlink" href="#module-taichi.lang.runtime_ops" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-taichi.lang.shell">
<span id="taichi-lang-shell-module"></span><h2>taichi.lang.shell module<a class="headerlink" href="#module-taichi.lang.shell" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-taichi.lang.snode">
<span id="taichi-lang-snode-module"></span><h2>taichi.lang.snode module<a class="headerlink" href="#module-taichi.lang.snode" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.snode.</span></span><span class="sig-name descname"><span class="pre">SNode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A Python-side SNode wrapper.</p>
<p>For more information on Taichi’s SNode system, please check out
these references:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.taichi.graphics/docs/lang/articles/advanced/sparse">https://docs.taichi.graphics/docs/lang/articles/advanced/sparse</a></p></li>
<li><p><a class="reference external" href="https://yuanming.taichi.graphics/publication/2019-taichi/taichi-lang.pdf">https://yuanming.taichi.graphics/publication/2019-taichi/taichi-lang.pdf</a></p></li>
</ul>
<dl class="simple">
<dt>Arg:</dt><dd><p>ptr (pointer): The C++ side SNode pointer.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.bit_array">
<span class="sig-name descname"><span class="pre">bit_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode.bit_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a bit_array SNode as a child component of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> (<em>List</em><em>[</em><em>Axis</em><em>]</em>) – Axes to activate.</p></li>
<li><p><strong>dimensions</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>int</em><em>]</em>) – Shape of each axis.</p></li>
<li><p><strong>num_bits</strong> (<em>int</em>) – Number of bits to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The added <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.bit_struct">
<span class="sig-name descname"><span class="pre">bit_struct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_bits</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode.bit_struct" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a bit_struct SNode as a child component of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_bits</strong> – Number of bits to use.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The added <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.bitmasked">
<span class="sig-name descname"><span class="pre">bitmasked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode.bitmasked" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a bitmasked SNode as a child component of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> (<em>List</em><em>[</em><em>Axis</em><em>]</em>) – Axes to activate.</p></li>
<li><p><strong>dimensions</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>int</em><em>]</em>) – Shape of each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The added <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.deactivate_all">
<span class="sig-name descname"><span class="pre">deactivate_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode.deactivate_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively deactivate all children components of <cite>self</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.dense">
<span class="sig-name descname"><span class="pre">dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode.dense" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a dense SNode as a child component of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> (<em>List</em><em>[</em><em>Axis</em><em>]</em>) – Axes to activate.</p></li>
<li><p><strong>dimensions</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>int</em><em>]</em>) – Shape of each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The added <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.dtype">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#taichi.lang.snode.SNode.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the data type of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The data type of <cite>self</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.dynamic">
<span class="sig-name descname"><span class="pre">dynamic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode.dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a dynamic SNode as a child component of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>List</em><em>[</em><em>Axis</em><em>]</em>) – Axis to activate, must be 1.</p></li>
<li><p><strong>dimension</strong> (<em>int</em>) – Shape of the axis.</p></li>
<li><p><strong>chunk_size</strong> (<em>int</em>) – Chunk size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The added <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.get_children">
<span class="sig-name descname"><span class="pre">get_children</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode.get_children" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all children components of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>All children components of <cite>self</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List[<a class="reference internal" href="#taichi.lang.snode.SNode" title="taichi.lang.snode.SNode">SNode</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.hash">
<span class="sig-name descname"><span class="pre">hash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode.hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Not supported.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.id">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#taichi.lang.snode.SNode.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the id of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The id of <cite>self</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.lazy_grad">
<span class="sig-name descname"><span class="pre">lazy_grad</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode.lazy_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically place the adjoint fields following the layout of their primal fields.</p>
<p>Users don’t need to specify <code class="docutils literal notranslate"><span class="pre">needs_grad</span></code> when they define scalar/vector/matrix fields (primal fields) using autodiff.
When all the primal fields are defined, using <code class="docutils literal notranslate"><span class="pre">taichi.root.lazy_grad()</span></code> could automatically generate
their corresponding adjoint fields (gradient field).</p>
<p>To know more details about primal, adjoint fields and <code class="docutils literal notranslate"><span class="pre">lazy_grad()</span></code>,
please see Page 4 and Page 13-14 of DiffTaichi Paper: <a class="reference external" href="https://arxiv.org/pdf/1910.00935.pdf">https://arxiv.org/pdf/1910.00935.pdf</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.loop_range">
<span class="sig-name descname"><span class="pre">loop_range</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode.loop_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the taichi_core.Expr wrapping the taichi_core.GlobalVariableExpression corresponding to <cite>self</cite> to serve as loop range.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>See above.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>taichi_core.Expr</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.name">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#taichi.lang.snode.SNode.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the name of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The name of <cite>self</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.needs_grad">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">needs_grad</span></span><a class="headerlink" href="#taichi.lang.snode.SNode.needs_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether <cite>self</cite> has a corresponding gradient <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether <cite>self</cite> has a corresponding gradient <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode.parent" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets an ancestor of <cite>self</cite> in the SNode tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> (<em>int</em>) – the number of levels going up from <cite>self</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The n-th parent of <cite>self</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[None, _Root, <a class="reference internal" href="#taichi.lang.snode.SNode" title="taichi.lang.snode.SNode">SNode</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.physical_index_position">
<span class="sig-name descname"><span class="pre">physical_index_position</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode.physical_index_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets mappings from virtual axes to physical axes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Mappings from virtual axes to physical axes.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dict[int, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.place">
<span class="sig-name descname"><span class="pre">place</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode.place" title="Permalink to this definition">¶</a></dt>
<dd><p>Places a list of Taichi fields under the <cite>self</cite> container.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>List</em><em>[</em><em>ti.field</em><em>]</em>) – A list of Taichi fields to place.</p></li>
<li><p><strong>offset</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>tuple</em><em>[</em><em>Number</em><em>]</em><em>]</em>) – Offset of the field domain.</p></li>
<li><p><strong>shared_exponent</strong> (<em>bool</em>) – Only useful for quant types.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The <cite>self</cite> container.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.pointer">
<span class="sig-name descname"><span class="pre">pointer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.snode.SNode.pointer" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a pointer SNode as a child component of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> (<em>List</em><em>[</em><em>Axis</em><em>]</em>) – Axes to activate.</p></li>
<li><p><strong>dimensions</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>int</em><em>]</em>) – Shape of each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The added <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.shape">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#taichi.lang.snode.SNode.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the number of elements from root in each axis of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The number of elements from root in each axis of <cite>self</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.snode.SNode.snode">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">snode</span></span><a class="headerlink" href="#taichi.lang.snode.SNode.snode" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>self</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#taichi.lang.snode.SNode" title="taichi.lang.snode.SNode">SNode</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-taichi.lang.tape">
<span id="taichi-lang-tape-module"></span><h2>taichi.lang.tape module<a class="headerlink" href="#module-taichi.lang.tape" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-taichi.lang.transformer">
<span id="taichi-lang-transformer-module"></span><h2>taichi.lang.transformer module<a class="headerlink" href="#module-taichi.lang.transformer" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.transformer.ASTTransformerBase">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.transformer.</span></span><span class="sig-name descname"><span class="pre">ASTTransformerBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.transformer.ASTTransformerBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ast.NodeTransformer</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.transformer.ASTTransformerChecks">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.transformer.</span></span><span class="sig-name descname"><span class="pre">ASTTransformerChecks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.transformer.ASTTransformerChecks" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#taichi.lang.transformer.ASTTransformerBase" title="taichi.lang.transformer.ASTTransformerBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">taichi.lang.transformer.ASTTransformerBase</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-taichi.lang.type_factory_impl">
<span id="taichi-lang-type-factory-impl-module"></span><h2>taichi.lang.type_factory_impl module<a class="headerlink" href="#module-taichi.lang.type_factory_impl" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.type_factory_impl.TypeFactory">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.type_factory_impl.</span></span><span class="sig-name descname"><span class="pre">TypeFactory</span></span><a class="headerlink" href="#taichi.lang.type_factory_impl.TypeFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A Python-side TypeFactory wrapper.</p>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.type_factory_impl.TypeFactory.custom_float">
<span class="sig-name descname"><span class="pre">custom_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">significand_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.type_factory_impl.TypeFactory.custom_float" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a custom float type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>significand_type</strong> (<em>DataType</em>) – Type of significand.</p></li>
<li><p><strong>exponent_type</strong> (<em>DataType</em>) – Type of exponent.</p></li>
<li><p><strong>compute_type</strong> (<em>DataType</em>) – Type for computation.</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – Scaling factor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The specified type.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.type_factory_impl.TypeFactory.custom_int">
<span class="sig-name descname"><span class="pre">custom_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.type_factory_impl.TypeFactory.custom_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a custom int type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bits</strong> (<em>int</em>) – Number of bits.</p></li>
<li><p><strong>signed</strong> (<em>bool</em>) – Signed or unsigned.</p></li>
<li><p><strong>compute_type</strong> (<em>DataType</em>) – Type for computation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The specified type.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-taichi.lang.util">
<span id="taichi-lang-util-module"></span><h2>taichi.lang.util module<a class="headerlink" href="#module-taichi.lang.util" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.util.has_pytorch">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.util.</span></span><span class="sig-name descname"><span class="pre">has_pytorch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.util.has_pytorch" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether has pytorch in the current Python environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if has pytorch else False.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.util.to_numpy_type">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.util.</span></span><span class="sig-name descname"><span class="pre">to_numpy_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.util.to_numpy_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert taichi data type to its counterpart in numpy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dt</strong> (<em>DataType</em>) – The desired data type to convert.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The counterpart data type in numpy.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.util.to_pytorch_type">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.util.</span></span><span class="sig-name descname"><span class="pre">to_pytorch_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.util.to_pytorch_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert taichi data type to its counterpart in torch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dt</strong> (<em>DataType</em>) – The desired data type to convert.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The counterpart data type in torch.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.util.to_taichi_type">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.util.</span></span><span class="sig-name descname"><span class="pre">to_taichi_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.util.to_taichi_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert numpy or torch data type to its counterpart in taichi.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dt</strong> (<em>DataType</em>) – The desired data type to convert.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The counterpart data type in taichi.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-taichi.lang">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-taichi.lang" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.AnyArray">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">AnyArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.AnyArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for arbitrary arrays in Python AST.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ptr</strong> (<em>taichi_core.Expr</em>) – A taichi_core.Expr wrapping a taichi_core.ExternalTensorExpression.</p></li>
<li><p><strong>element_shape</strong> (<em>Tuple</em><em>[</em><em>Int</em><em>]</em>) – () if scalar elements (default), (n) if vector elements, and (n, m) if matrix elements.</p></li>
<li><p><strong>layout</strong> (<a class="reference internal" href="#taichi.lang.Layout" title="taichi.lang.Layout"><em>Layout</em></a>) – Memory layout.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.AnyArray.shape">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#taichi.lang.AnyArray.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A list containing sizes for each dimension. Note that element shape will be excluded.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The result list.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List[Int]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.AnyArrayAccess">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">AnyArrayAccess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_first</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.AnyArrayAccess" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for first-level access to AnyArray with Vector/Matrix elements in Python AST.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<a class="reference internal" href="#taichi.lang.AnyArray" title="taichi.lang.AnyArray"><em>AnyArray</em></a>) – See above.</p></li>
<li><p><strong>indices_first</strong> (<em>Tuple</em><em>[</em><em>Int</em><em>]</em>) – Indices of first-level access.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.Expr">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">Expr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#taichi.lang.common_ops.TaichiOperations" title="taichi.lang.common_ops.TaichiOperations"><code class="xref py py-class docutils literal notranslate"><span class="pre">taichi.lang.common_ops.TaichiOperations</span></code></a></p>
<p>A Python-side Expr wrapper, whose member variable <cite>ptr</cite> is an instance of C++ Expr class. A C++ Expr object contains member variable <cite>expr</cite> which holds an instance of C++ Expression class.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.ExtArray">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">ExtArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ExtArray" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for external arrays. Constructed by a taichi_core.Expr wrapping a taichi_core.ExternalTensorExpression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ptr</strong> (<em>taichi_core.Expr</em>) – See above.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.ExtArray.loop_range">
<span class="sig-name descname"><span class="pre">loop_range</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ExtArray.loop_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the corresponding taichi_core.Expr to serve as loop range.</p>
<p>This is not in use now because struct fors on ExtArrays are not supported yet.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>See above.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>taichi_core.Expr</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.ExtArray.shape">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#taichi.lang.ExtArray.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>A list containing sizes for each dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The result list.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List[Int]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.Field">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">Field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vars</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Field" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Taichi field with SNode implementation.</p>
<p>A field is constructed by a list of field members.
For example, a scalar field has 1 field member, while a 3x3 matrix field has 9 field members.
A field member is a Python Expr wrapping a C++ GlobalVariableExpression.
A C++ GlobalVariableExpression wraps the corresponding SNode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vars</strong> (<em>List</em><em>[</em><a class="reference internal" href="#taichi.lang.Expr" title="taichi.lang.Expr"><em>Expr</em></a><em>]</em>) – Field members.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Field.copy_from">
<span class="sig-name descname"><span class="pre">copy_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Field.copy_from" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies all elements from another field.</p>
<p>The shape of the other field needs to be the same as <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#taichi.lang.Field" title="taichi.lang.Field"><em>Field</em></a>) – The source field.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.Field.dtype">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#taichi.lang.Field.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets data type of each individual value.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Data type of each individual value.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Field.fill">
<span class="sig-name descname"><span class="pre">fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Field.fill" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills <cite>self</cite> with a specific value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>val</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Value to fill.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Field.from_numpy">
<span class="sig-name descname"><span class="pre">from_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Field.from_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads all elements from a numpy array.</p>
<p>The shape of the numpy array needs to be the same as <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>numpy.ndarray</em>) – The source numpy array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Field.from_torch">
<span class="sig-name descname"><span class="pre">from_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Field.from_torch" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads all elements from a torch tensor.</p>
<p>The shape of the torch tensor needs to be the same as <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>torch.tensor</em>) – The source torch tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Field.get_field_members">
<span class="sig-name descname"><span class="pre">get_field_members</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Field.get_field_members" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets field members.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Field members.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List[<a class="reference internal" href="#taichi.lang.Expr" title="taichi.lang.Expr">Expr</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Field.loop_range">
<span class="sig-name descname"><span class="pre">loop_range</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Field.loop_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets representative field member for loop range info.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Representative (first) field member.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>taichi_core.Expr</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.Field.name">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#taichi.lang.Field.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets field name.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Field name.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Field.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Field.parent" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets an ancestor of the representative SNode in the SNode tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> (<em>int</em>) – the number of levels going up from the representative SNode.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The n-th parent of the representative SNode.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode">SNode</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Field.set_grad">
<span class="sig-name descname"><span class="pre">set_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grad</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Field.set_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets corresponding gradient field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>grad</strong> (<a class="reference internal" href="#taichi.lang.Field" title="taichi.lang.Field"><em>Field</em></a>) – Corresponding gradient field.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.Field.shape">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#taichi.lang.Field.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets field shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Field shape.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple[Int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.Field.snode">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">snode</span></span><a class="headerlink" href="#taichi.lang.Field.snode" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets representative SNode for info purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Representative SNode (SNode of first field member).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode">SNode</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Field.to_numpy">
<span class="sig-name descname"><span class="pre">to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Field.to_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts <cite>self</cite> to a numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dtype</strong> (<em>DataType</em><em>, </em><em>optional</em>) – The desired data type of returned numpy array.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result numpy array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Field.to_torch">
<span class="sig-name descname"><span class="pre">to_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Field.to_torch" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts <cite>self</cite> to a torch tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The desired device of returned tensor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result torch tensor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.FieldsBuilder">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">FieldsBuilder</span></span><a class="headerlink" href="#taichi.lang.FieldsBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A builder that constructs a SNodeTree instance.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">)</span>
<span class="n">fb</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">FieldsBuilder</span><span class="p">()</span>
<span class="n">fb</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">ij</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">fb</span><span class="o">.</span><span class="n">pointer</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">ij</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">ij</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Afer this line, `x` and `y` are placed. No more fields can be placed</span>
<span class="c1"># into `fb`.</span>
<span class="c1">#</span>
<span class="c1"># The tree looks like the following:</span>
<span class="c1"># (implicit root)</span>
<span class="c1">#  |</span>
<span class="c1">#  +-- dense +-- place(x)</span>
<span class="c1">#  |</span>
<span class="c1">#  +-- pointer +-- dense +-- place(y)</span>
<span class="n">fb</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.FieldsBuilder.bit_array">
<span class="sig-name descname"><span class="pre">bit_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">taichi_core.Axis</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">taichi_core.Axis</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.FieldsBuilder.bit_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#taichi.lang.SNode.bit_array" title="taichi.lang.SNode.bit_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.SNode.bit_array()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.FieldsBuilder.bit_struct">
<span class="sig-name descname"><span class="pre">bit_struct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_bits</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.FieldsBuilder.bit_struct" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#taichi.lang.SNode.bit_struct" title="taichi.lang.SNode.bit_struct"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.SNode.bit_struct()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.FieldsBuilder.bitmasked">
<span class="sig-name descname"><span class="pre">bitmasked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">taichi_core.Axis</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">taichi_core.Axis</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.FieldsBuilder.bitmasked" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#taichi.lang.SNode.bitmasked" title="taichi.lang.SNode.bitmasked"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.SNode.bitmasked()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.FieldsBuilder.dense">
<span class="sig-name descname"><span class="pre">dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">taichi_core.Axis</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">taichi_core.Axis</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.FieldsBuilder.dense" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#taichi.lang.SNode.dense" title="taichi.lang.SNode.dense"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.SNode.dense()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.FieldsBuilder.dynamic">
<span class="sig-name descname"><span class="pre">dynamic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">taichi_core.Axis</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">taichi_core.Axis</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.FieldsBuilder.dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#taichi.lang.SNode.dynamic" title="taichi.lang.SNode.dynamic"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.SNode.dynamic()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.FieldsBuilder.finalize">
<span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raise_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.FieldsBuilder.finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs the SNodeTree and finalizes this builder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raise_warning</strong> (<em>bool</em>) – Raise warning or not.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.FieldsBuilder.finalized_roots">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">finalized_roots</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.FieldsBuilder.finalized_roots" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all the roots of the finalized SNodeTree.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of the roots of the finalized SNodeTree.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.FieldsBuilder.hash">
<span class="sig-name descname"><span class="pre">hash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.FieldsBuilder.hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#taichi.lang.SNode.hash" title="taichi.lang.SNode.hash"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.SNode.hash()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.FieldsBuilder.lazy_grad">
<span class="sig-name descname"><span class="pre">lazy_grad</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.FieldsBuilder.lazy_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#taichi.lang.SNode.lazy_grad" title="taichi.lang.SNode.lazy_grad"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.SNode.lazy_grad()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.FieldsBuilder.place">
<span class="sig-name descname"><span class="pre">place</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_exponent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.FieldsBuilder.place" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#taichi.lang.SNode.place" title="taichi.lang.SNode.place"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.SNode.place()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.FieldsBuilder.pointer">
<span class="sig-name descname"><span class="pre">pointer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">taichi_core.Axis</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">taichi_core.Axis</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.FieldsBuilder.pointer" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="#taichi.lang.SNode.pointer" title="taichi.lang.SNode.pointer"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.SNode.pointer()</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="taichi.lang.InvalidOperationError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">InvalidOperationError</span></span><a class="headerlink" href="#taichi.lang.InvalidOperationError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="taichi.lang.KernelArgError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">KernelArgError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">needed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">provided</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.KernelArgError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="taichi.lang.KernelDefError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">KernelDefError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.KernelDefError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.Layout">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">Layout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Layout" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Layout of a Taichi field or ndarray.</p>
<p>Currently, AOS (array of structures) and SOA (structure of arrays) are supported.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.Matrix">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">Matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Layout.AOS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">needs_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_local_tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#taichi.lang.common_ops.TaichiOperations" title="taichi.lang.common_ops.TaichiOperations"><code class="xref py py-class docutils literal notranslate"><span class="pre">taichi.lang.common_ops.TaichiOperations</span></code></a></p>
<p>The matrix class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – the first dimension of a matrix.</p></li>
<li><p><strong>m</strong> (<em>int</em>) – the second dimension of a matrix.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em>) – the elmement data type.</p></li>
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple of int</em><em>]</em><em>, </em><em>optional</em>) – the shape of a matrix field.</p></li>
<li><p><strong>offset</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple of int</em><em>]</em><em>, </em><em>optional</em>) – The coordinate offset of all elements in a field.</p></li>
<li><p><strong>empty</strong> (<em>Bool</em><em>, </em><em>deprecated</em>) – True if the matrix is empty, False otherwise.</p></li>
<li><p><strong>layout</strong> (<a class="reference internal" href="#taichi.lang.Layout" title="taichi.lang.Layout"><em>Layout</em></a><em>, </em><em>optional</em>) – The filed layout (Layout.AOS or Layout.SOA).</p></li>
<li><p><strong>needs_grad</strong> (<em>Bool</em><em>, </em><em>optional</em>) – True if used in auto diff, False otherwise.</p></li>
<li><p><strong>keep_raw</strong> (<em>Bool</em><em>, </em><em>optional</em>) – Keep the contents in <cite>n</cite> as is.</p></li>
<li><p><strong>rows</strong> (<em>List</em><em>, </em><em>deprecated</em>) – construct matrix rows.</p></li>
<li><p><strong>cols</strong> (<em>List</em><em>, </em><em>deprecated</em>) – construct matrix columns.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.all">
<span class="sig-name descname"><span class="pre">all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.all" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether all element not equal zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if all elements are not equal zero, False otherwise.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.any">
<span class="sig-name descname"><span class="pre">any</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.any" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether any element not equal zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if any element is not equal zero, False otherwise.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.cast">
<span class="sig-name descname"><span class="pre">cast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.cast" title="Permalink to this definition">¶</a></dt>
<dd><p>Cast the matrix element data type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dtype</strong> (<em>DataType</em>) – the data type of the casted matrix element.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A new matrix with each element’s type is dtype.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.cols">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">cols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.cols" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Matrix instance by concactinating Vectors/lists column by column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cols</strong> (<em>List</em>) – A list of Vector (1-D Matrix) or a list of list.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance filled with the Vectors/lists column by column.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.cross">
<span class="sig-name descname"><span class="pre">cross</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.cross" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the cross product with the input Vector (1-D Matrix).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>) – The input Vector (1-D Matrix) to perform the cross product.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The cross product result (1-D Matrix) of the two Vectors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.determinant">
<span class="sig-name descname"><span class="pre">determinant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.determinant" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the determinant of a matrix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The matrix dimension should be less than or equal to 4.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The determinant of a matrix.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – Determinants of matrices with sizes &gt;= 5 are not supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.diag">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.diag" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a diagonal square matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<em>int</em>) – the dimension of a square matrix.</p></li>
<li><p><strong>val</strong> (<em>TypeVar</em>) – the diagonal elment value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The constructed diagonal square matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.dot">
<span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the dot product with the input Vector (1-D Matrix).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>) – The input Vector (1-D Matrix) to perform the dot product.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The dot product result (scalar) of the two Vectors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.empty">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the matrix and fill None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The number of the row of the matrix.</p></li>
<li><p><strong>m</strong> (<em>int</em>) – The number of the column of the matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance filled with None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.field">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">needs_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Layout.AOS</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.field" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a data container to hold all elements of the Matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The desired number of rows of the Matrix.</p></li>
<li><p><strong>m</strong> (<em>int</em>) – The desired number of columns of the Matrix.</p></li>
<li><p><strong>dtype</strong> (<em>DataType</em><em>, </em><em>optional</em>) – The desired data type of the Matrix.</p></li>
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple of int</em><em>]</em><em>, </em><em>optional</em>) – The desired shape of the Matrix.</p></li>
<li><p><strong>name</strong> (<em>string</em><em>, </em><em>optional</em>) – The custom name of the field.</p></li>
<li><p><strong>offset</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple of int</em><em>]</em><em>, </em><em>optional</em>) – The coordinate offset of all elements in a field.</p></li>
<li><p><strong>needs_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether the Matrix need gradients.</p></li>
<li><p><strong>layout</strong> (<a class="reference internal" href="#taichi.lang.Layout" title="taichi.lang.Layout"><em>Layout</em></a><em>, </em><em>optional</em>) – The field layout, i.e., Array Of Structure (AOS) or Structure Of Array (SOA).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance serves as the data container.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.fill">
<span class="sig-name descname"><span class="pre">fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.fill" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills the matrix with a specific value in Taichi scope.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>val</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Value to fill.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.identity">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.identity" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an identity Matrix with shape (n, n).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> (<em>DataType</em>) – The desired data type.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The number of rows/columns.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A n x n identity <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.inverse">
<span class="sig-name descname"><span class="pre">inverse</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse of a matrix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The matrix dimension should be less than or equal to 4.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The inverse of a matrix.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – Inversions of matrices with sizes &gt;= 5 are not supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.inversed">
<span class="sig-name descname"><span class="pre">inversed</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.inversed" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse of a matrix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The matrix dimension should be less than or equal to 4.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The inverse of a matrix.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – Inversions of matrices with sizes &gt;= 5 are not supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.max">
<span class="sig-name descname"><span class="pre">max</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.max" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximum element value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.min">
<span class="sig-name descname"><span class="pre">min</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.min" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the minumum element value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the square root of the sum of the absolute squares of its elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eps</strong> (<em>Number</em>) – a safe-guard value for sqrt, usually 0.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">a</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="c1"># sqrt(3*3 + 4*4 + 0) = 5</span>
<span class="c1"># `a.norm(eps)` is equivalent to `ti.sqrt(a.dot(a) + eps).`</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The square root of the sum of the absolute squares of its elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.norm_inv">
<span class="sig-name descname"><span class="pre">norm_inv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.norm_inv" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the inverse of the matrix/vector <cite>norm</cite>. For <cite>norm</cite>: please see <a class="reference internal" href="#taichi.lang.matrix.Matrix.norm" title="taichi.lang.matrix.Matrix.norm"><code class="xref py py-func docutils literal notranslate"><span class="pre">norm()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eps</strong> (<em>Number</em>) – a safe-guard value for sqrt, usually 0.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The inverse of the matrix/vector <cite>norm</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.norm_sqr">
<span class="sig-name descname"><span class="pre">norm_sqr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.norm_sqr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sum of the absolute squares of its elements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.normalized">
<span class="sig-name descname"><span class="pre">normalized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.normalized" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize a vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eps</strong> (<em>Number</em>) – a safe-guard value for sqrt, usually 0.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">a</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span> <span class="c1"># [3 / 5, 4 / 5]</span>
<span class="c1"># `a.normalized()` is equivalent to `a / a.norm()`.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only vector normalization is supported.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.one">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">one</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.one" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Matrix filled with ones.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> (<em>DataType</em>) – The desired data type.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The first dimension (row) of the matrix.</p></li>
<li><p><strong>m</strong> (<em>int</em><em>, </em><em>optional</em>) – The second dimension (column) of the matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance filled with ones.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.outer_product">
<span class="sig-name descname"><span class="pre">outer_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.outer_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the outer product with the input Vector (1-D Matrix).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>) – The input Vector (1-D Matrix) to perform the outer product.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The outer product result (Matrix) of the two Vectors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.rows">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rows</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Matrix instance by concactinating Vectors/lists row by row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rows</strong> (<em>List</em>) – A list of Vector (1-D Matrix) or a list of list.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance filled with the Vectors/lists row by row.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.sum">
<span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sum of all elements.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.to_numpy">
<span class="sig-name descname"><span class="pre">to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.to_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the Matrix to a numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>keep_dims</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to keep the dimension after conversion.
When keep_dims=False, the resulting numpy array should skip the matrix dims with size 1.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result numpy array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.trace">
<span class="sig-name descname"><span class="pre">trace</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.trace" title="Permalink to this definition">¶</a></dt>
<dd><p>The sum of a matrix diagonal elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The sum of a matrix diagonal elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.transpose">
<span class="sig-name descname"><span class="pre">transpose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the transpose of a matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Get the transpose of a matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.unit">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an unit Vector (1-D matrix) i.e., a vector with only one entry filled with one and all other entries zeros.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The length of the vector.</p></li>
<li><p><strong>i</strong> (<em>int</em>) – The index of the entry that will be filled with one.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em><em>, </em><em>optional</em>) – The desired data type.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An 1-D unit <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.var">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.var" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.Matrix.w">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">w</span></span><a class="headerlink" href="#taichi.lang.Matrix.w" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the fourth element of a matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.with_entries">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">with_entries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entries</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.with_entries" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Matrix instance by giving all entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Number of rows of the matrix.</p></li>
<li><p><strong>m</strong> (<em>int</em>) – Number of columns of the matrix.</p></li>
<li><p><strong>entries</strong> (<em>List</em><em>[</em><em>Any</em><em>]</em>) – Given entries.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance filled with given entries.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.Matrix" title="taichi.lang.Matrix">Matrix</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.Matrix.x">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#taichi.lang.Matrix.x" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the first element of a matrix.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.Matrix.y">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">y</span></span><a class="headerlink" href="#taichi.lang.Matrix.y" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the second element of a matrix.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.Matrix.z">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">z</span></span><a class="headerlink" href="#taichi.lang.Matrix.z" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the third element of a matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.Matrix.zero">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Matrix.zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Matrix filled with zeros.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> (<em>DataType</em>) – The desired data type.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The first dimension (row) of the matrix.</p></li>
<li><p><strong>m</strong> (<em>int</em><em>, </em><em>optional</em>) – The second dimension (column) of the matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a> instance filled with zeros.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.MatrixField">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">MatrixField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.MatrixField" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#taichi.lang.Field" title="taichi.lang.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">taichi.lang.field.Field</span></code></a></p>
<p>Taichi matrix field with SNode implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vars</strong> (<a class="reference internal" href="#taichi.lang.Expr" title="taichi.lang.Expr"><em>Expr</em></a>) – Field members.</p></li>
<li><p><strong>n</strong> (<em>Int</em>) – Number of rows.</p></li>
<li><p><strong>m</strong> (<em>Int</em>) – Number of columns.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.MatrixField.fill">
<span class="sig-name descname"><span class="pre">fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.MatrixField.fill" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills <cite>self</cite> with specific values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>val</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>List</em><em>, </em><em>Tuple</em><em>, </em><a class="reference internal" href="#taichi.lang.Matrix" title="taichi.lang.Matrix"><em>Matrix</em></a><em>]</em>) – Values to fill, which should have dimension consistent with <cite>self</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.MatrixField.from_numpy">
<span class="sig-name descname"><span class="pre">from_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.MatrixField.from_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads all elements from a numpy array.</p>
<p>The shape of the numpy array needs to be the same as <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>numpy.ndarray</em>) – The source numpy array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.MatrixField.get_scalar_field">
<span class="sig-name descname"><span class="pre">get_scalar_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.MatrixField.get_scalar_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a ScalarField using a specific field member. Only used for quant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>indices</strong> (<em>Tuple</em><em>[</em><em>Int</em><em>]</em>) – Specified indices of the field member.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result ScalarField.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.ScalarField" title="taichi.lang.ScalarField">ScalarField</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.MatrixField.to_numpy">
<span class="sig-name descname"><span class="pre">to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.MatrixField.to_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts <cite>self</cite> to a numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keep_dims</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to keep the dimension after conversion.
When keep_dims=True, on an n-D matrix field, the numpy array always has n+2 dims, even for 1x1, 1xn, nx1 matrix fields.
When keep_dims=False, the resulting numpy array should skip the matrix dims with size 1.
For example, a 4x1 or 1x4 matrix field with 5x6x7 elements results in an array of shape 5x6x7x4.</p></li>
<li><p><strong>as_vector</strong> (<em>bool</em><em>, </em><em>deprecated</em>) – Whether to make the returned numpy array as a vector, i.e., with shape (n,) rather than (n, 1).
Note that this argument has been deprecated.
More discussion about <cite>as_vector</cite>: <a class="reference external" href="https://github.com/taichi-dev/taichi/pull/1046#issuecomment-633548858">https://github.com/taichi-dev/taichi/pull/1046#issuecomment-633548858</a>.</p></li>
<li><p><strong>dtype</strong> (<em>DataType</em><em>, </em><em>optional</em>) – The desired data type of returned numpy array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result numpy array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.MatrixField.to_torch">
<span class="sig-name descname"><span class="pre">to_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.MatrixField.to_torch" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts <cite>self</cite> to a torch tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The desired device of returned tensor.</p></li>
<li><p><strong>keep_dims</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to keep the dimension after conversion.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">to_numpy()</span></code> for more detailed explanation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result torch tensor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.SNode">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">SNode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ptr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A Python-side SNode wrapper.</p>
<p>For more information on Taichi’s SNode system, please check out
these references:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.taichi.graphics/docs/lang/articles/advanced/sparse">https://docs.taichi.graphics/docs/lang/articles/advanced/sparse</a></p></li>
<li><p><a class="reference external" href="https://yuanming.taichi.graphics/publication/2019-taichi/taichi-lang.pdf">https://yuanming.taichi.graphics/publication/2019-taichi/taichi-lang.pdf</a></p></li>
</ul>
<dl class="simple">
<dt>Arg:</dt><dd><p>ptr (pointer): The C++ side SNode pointer.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.SNode.bit_array">
<span class="sig-name descname"><span class="pre">bit_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bits</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode.bit_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a bit_array SNode as a child component of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> (<em>List</em><em>[</em><em>Axis</em><em>]</em>) – Axes to activate.</p></li>
<li><p><strong>dimensions</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>int</em><em>]</em>) – Shape of each axis.</p></li>
<li><p><strong>num_bits</strong> (<em>int</em>) – Number of bits to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The added <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.SNode.bit_struct">
<span class="sig-name descname"><span class="pre">bit_struct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_bits</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode.bit_struct" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a bit_struct SNode as a child component of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_bits</strong> – Number of bits to use.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The added <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.SNode.bitmasked">
<span class="sig-name descname"><span class="pre">bitmasked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode.bitmasked" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a bitmasked SNode as a child component of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> (<em>List</em><em>[</em><em>Axis</em><em>]</em>) – Axes to activate.</p></li>
<li><p><strong>dimensions</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>int</em><em>]</em>) – Shape of each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The added <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.SNode.deactivate_all">
<span class="sig-name descname"><span class="pre">deactivate_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode.deactivate_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively deactivate all children components of <cite>self</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.SNode.dense">
<span class="sig-name descname"><span class="pre">dense</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode.dense" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a dense SNode as a child component of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> (<em>List</em><em>[</em><em>Axis</em><em>]</em>) – Axes to activate.</p></li>
<li><p><strong>dimensions</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>int</em><em>]</em>) – Shape of each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The added <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.SNode.dtype">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">dtype</span></span><a class="headerlink" href="#taichi.lang.SNode.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the data type of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The data type of <cite>self</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.SNode.dynamic">
<span class="sig-name descname"><span class="pre">dynamic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode.dynamic" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a dynamic SNode as a child component of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>List</em><em>[</em><em>Axis</em><em>]</em>) – Axis to activate, must be 1.</p></li>
<li><p><strong>dimension</strong> (<em>int</em>) – Shape of the axis.</p></li>
<li><p><strong>chunk_size</strong> (<em>int</em>) – Chunk size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The added <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.SNode.get_children">
<span class="sig-name descname"><span class="pre">get_children</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode.get_children" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all children components of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>All children components of <cite>self</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List[<a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode">SNode</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.SNode.hash">
<span class="sig-name descname"><span class="pre">hash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode.hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Not supported.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.SNode.id">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#taichi.lang.SNode.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the id of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The id of <cite>self</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.SNode.lazy_grad">
<span class="sig-name descname"><span class="pre">lazy_grad</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode.lazy_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically place the adjoint fields following the layout of their primal fields.</p>
<p>Users don’t need to specify <code class="docutils literal notranslate"><span class="pre">needs_grad</span></code> when they define scalar/vector/matrix fields (primal fields) using autodiff.
When all the primal fields are defined, using <code class="docutils literal notranslate"><span class="pre">taichi.root.lazy_grad()</span></code> could automatically generate
their corresponding adjoint fields (gradient field).</p>
<p>To know more details about primal, adjoint fields and <code class="docutils literal notranslate"><span class="pre">lazy_grad()</span></code>,
please see Page 4 and Page 13-14 of DiffTaichi Paper: <a class="reference external" href="https://arxiv.org/pdf/1910.00935.pdf">https://arxiv.org/pdf/1910.00935.pdf</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.SNode.loop_range">
<span class="sig-name descname"><span class="pre">loop_range</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode.loop_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the taichi_core.Expr wrapping the taichi_core.GlobalVariableExpression corresponding to <cite>self</cite> to serve as loop range.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>See above.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>taichi_core.Expr</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.SNode.name">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#taichi.lang.SNode.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the name of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The name of <cite>self</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.SNode.needs_grad">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">needs_grad</span></span><a class="headerlink" href="#taichi.lang.SNode.needs_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether <cite>self</cite> has a corresponding gradient <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether <cite>self</cite> has a corresponding gradient <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.SNode.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode.parent" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets an ancestor of <cite>self</cite> in the SNode tree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> (<em>int</em>) – the number of levels going up from <cite>self</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The n-th parent of <cite>self</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[None, _Root, <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode">SNode</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.SNode.physical_index_position">
<span class="sig-name descname"><span class="pre">physical_index_position</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode.physical_index_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets mappings from virtual axes to physical axes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Mappings from virtual axes to physical axes.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dict[int, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.SNode.place">
<span class="sig-name descname"><span class="pre">place</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared_exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode.place" title="Permalink to this definition">¶</a></dt>
<dd><p>Places a list of Taichi fields under the <cite>self</cite> container.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<em>List</em><em>[</em><em>ti.field</em><em>]</em>) – A list of Taichi fields to place.</p></li>
<li><p><strong>offset</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>tuple</em><em>[</em><em>Number</em><em>]</em><em>]</em>) – Offset of the field domain.</p></li>
<li><p><strong>shared_exponent</strong> (<em>bool</em>) – Only useful for quant types.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The <cite>self</cite> container.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.SNode.pointer">
<span class="sig-name descname"><span class="pre">pointer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.SNode.pointer" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a pointer SNode as a child component of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> (<em>List</em><em>[</em><em>Axis</em><em>]</em>) – Axes to activate.</p></li>
<li><p><strong>dimensions</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>int</em><em>]</em>) – Shape of each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The added <a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a> instance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.SNode.shape">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#taichi.lang.SNode.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the number of elements from root in each axis of <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The number of elements from root in each axis of <cite>self</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.SNode.snode">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">snode</span></span><a class="headerlink" href="#taichi.lang.SNode.snode" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><cite>self</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#taichi.lang.SNode" title="taichi.lang.SNode">SNode</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.ScalarField">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">ScalarField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ScalarField" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#taichi.lang.Field" title="taichi.lang.field.Field"><code class="xref py py-class docutils literal notranslate"><span class="pre">taichi.lang.field.Field</span></code></a></p>
<p>Taichi scalar field with SNode implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>var</strong> (<a class="reference internal" href="#taichi.lang.Expr" title="taichi.lang.Expr"><em>Expr</em></a>) – Field member.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.ScalarField.fill">
<span class="sig-name descname"><span class="pre">fill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ScalarField.fill" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills <cite>self</cite> with a specific value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>val</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Value to fill.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.ScalarField.from_numpy">
<span class="sig-name descname"><span class="pre">from_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ScalarField.from_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads all elements from a numpy array.</p>
<p>The shape of the numpy array needs to be the same as <cite>self</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>numpy.ndarray</em>) – The source numpy array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.ScalarField.to_numpy">
<span class="sig-name descname"><span class="pre">to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ScalarField.to_numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts <cite>self</cite> to a numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dtype</strong> (<em>DataType</em><em>, </em><em>optional</em>) – The desired data type of returned numpy array.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result numpy array.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.lang.ScalarField.to_torch">
<span class="sig-name descname"><span class="pre">to_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ScalarField.to_torch" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts <cite>self</cite> to a torch tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>device</strong> (<em>torch.device</em><em>, </em><em>optional</em>) – The desired device of returned tensor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The result torch tensor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.lang.ScalarNdarray">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">ScalarNdarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ScalarNdarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">taichi.lang.ndarray.Ndarray</span></code></p>
<p>Taichi ndarray with scalar elements implemented with a torch tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<em>DataType</em>) – Data type of the ndarray.</p></li>
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple</em><em>[</em><em>int</em><em>]</em><em>]</em>) – Shape of the ndarray.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="taichi.lang.ScalarNdarray.shape">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#taichi.lang.ScalarNdarray.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets ndarray shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Ndarray shape.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Tuple[Int]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="taichi.lang.TaichiSyntaxError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">TaichiSyntaxError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.TaichiSyntaxError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.Tape">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">Tape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clear_gradients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Tape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a context manager of <code class="xref py py-class docutils literal notranslate"><span class="pre">TapeImpl</span></code>. The
context manager would catching all of the callings of functions that
decorated by <a class="reference internal" href="#taichi.lang.kernel_impl.kernel" title="taichi.lang.kernel_impl.kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">kernel()</span></code></a> or
<a class="reference internal" href="#taichi.lang.complex_kernel" title="taichi.lang.complex_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">complex_kernel()</span></code></a> under <cite>with</cite> statement, and calculate
all the partial gradients of a given loss variable by calling all of the
gradient function of the callings caught in reverse order while <cite>with</cite>
statement ended.</p>
<p>See also <a class="reference internal" href="#taichi.lang.kernel_impl.kernel" title="taichi.lang.kernel_impl.kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">kernel()</span></code></a> and
<a class="reference internal" href="#taichi.lang.complex_kernel" title="taichi.lang.complex_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">complex_kernel()</span></code></a> for gradient functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss</strong> (<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>) – The loss field, which shape should be ().</p></li>
<li><p><strong>clear_gradients</strong> (<em>Bool</em>) – Before <cite>with</cite> body start, clear all gradients or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The context manager.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TapeImpl</span></code></p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">float32</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">y</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">I</span><span class="p">]</span> <span class="o">**</span> <span class="n">a</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">ti</span><span class="o">.</span><span class="n">Tape</span><span class="p">(</span><span class="n">loss</span> <span class="o">=</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">sum</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.Vector">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">Vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.Vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a <cite>Vector</cite> instance i.e. 1-D Matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The desired number of entries of the Vector.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em><em>, </em><em>optional</em>) – The desired data type of the Vector.</p></li>
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple of int</em><em>]</em><em>, </em><em>optional</em>) – The shape of the Vector.</p></li>
<li><p><strong>offset</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple of int</em><em>]</em><em>, </em><em>optional</em>) – The coordinate offset of all elements in a field.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Vector instance (1-D <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.abs">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.abs" title="Permalink to this definition">¶</a></dt>
<dd><p>The absolute value function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The absolute value of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.acos">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">acos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.acos" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverses function of cosine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements in [-1,1].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The inverses function of cosine of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.add">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.add" title="Permalink to this definition">¶</a></dt>
<dd><p>The add function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sum of <cite>a</cite> and <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="taichi.lang.any_arr">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">any_arr</span></span><a class="headerlink" href="#taichi.lang.any_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#taichi.lang.kernel_arguments.ArgAnyArray" title="taichi.lang.kernel_arguments.ArgAnyArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArgAnyArray</span></code></a>.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">to_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">any_arr</span><span class="p">(),</span> <span class="n">y</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">any_arr</span><span class="p">()):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f64</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">...</span> <span class="c1"># calculate y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  <span class="c1"># `x` will be filled with `y`&#39;s data.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.archs_with">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">archs_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">archs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">init_kwags</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.archs_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the test on the given archs with the given init args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>archs</strong> – a list of Taichi archs</p></li>
<li><p><strong>init_kwargs</strong> – kwargs passed to ti.init()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.asin">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">asin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.asin" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverses function of sine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements in [-1,1].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The inverses function of sine of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.atan2">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">atan2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.atan2" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverses of the tangent function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements not equal to zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The inverses function of tangent of <cite>b/a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.bit_and">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">bit_and</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.bit_and" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bitwise-and</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS bitwise-and with RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.bit_not">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">bit_not</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.bit_not" title="Permalink to this definition">¶</a></dt>
<dd><p>The bit not function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Bitwise not of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.bit_or">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">bit_or</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.bit_or" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes bitwise-or</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS bitwise-or with RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.bit_sar">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">bit_sar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.bit_sar" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bitwise shift right</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS &gt;&gt; RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.bit_shl">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">bit_shl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.bit_shl" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bitwise shift left</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS &lt;&lt; RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.bit_shr">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">bit_shr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.bit_shr" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bitwise shift right (in taichi scope)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS &gt;&gt; RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.bit_vectorize">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">bit_vectorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg0</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#taichi.lang.bit_vectorize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.bit_xor">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">bit_xor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.bit_xor" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bitwise-xor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS bitwise-xor with RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.block_dim">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">block_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg0</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#taichi.lang.block_dim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ceil">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">ceil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ceil" title="Permalink to this definition">¶</a></dt>
<dd><p>The ceil function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The least integer greater than or equal to <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.clear_all_gradients">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">clear_all_gradients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.clear_all_gradients" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all fields’ gradients to 0.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.clear_kernel_profile_info">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">clear_kernel_profile_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.clear_kernel_profile_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear all KernelProfiler records.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.cmp_eq">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">cmp_eq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.cmp_eq" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two values (equal to)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if LHS is equal to RHS, False otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.cmp_ge">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">cmp_ge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.cmp_ge" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two values (greater than or equal to)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if LHS is greater than or equal to RHS, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.cmp_gt">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">cmp_gt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.cmp_gt" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two values (greater than)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if LHS is strictly larger than RHS, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.cmp_le">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">cmp_le</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.cmp_le" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two values (less than or equal to)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if LHS is smaller than or equal to RHS, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.cmp_lt">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">cmp_lt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.cmp_lt" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two values (less than)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if LHS is strictly smaller than RHS, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.cmp_ne">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">cmp_ne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.cmp_ne" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two values (not equal to)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if LHS is not equal to RHS, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.complex_kernel">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">complex_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.complex_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>A decorator for python function that user can customize the gradient
function by the decorator generated by
<a class="reference internal" href="#taichi.lang.complex_kernel_grad" title="taichi.lang.complex_kernel_grad"><code class="xref py py-func docutils literal notranslate"><span class="pre">complex_kernel_grad()</span></code></a> for this function, and could be
caught automatically by ti.Tape(). This decorator would not automatically
converted the function to a taichi kernel. Users should call other taichi
kernels if in need to enable automatic parallel computing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fn</strong> (<em>Callable</em>) – The Python function which needs to be decorated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The decorated function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">float32</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">y</span><span class="p">[</span><span class="n">I</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">I</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">multiply_grad</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">float32</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">x</span><span class="o">.</span><span class="n">grad</span><span class="p">[</span><span class="n">I</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">grad</span><span class="p">[</span><span class="n">I</span><span class="p">]</span> <span class="o">/</span> <span class="n">a</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">complex_kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">multiply</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">complex_kernel_grad</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">foo_grad</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">multiply_grad</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.complex_kernel_grad">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">complex_kernel_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">primal</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.complex_kernel_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the gradient decorator for a given function decorated by
<a class="reference internal" href="#taichi.lang.complex_kernel" title="taichi.lang.complex_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">complex_kernel()</span></code></a>. See <a class="reference internal" href="#taichi.lang.complex_kernel" title="taichi.lang.complex_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">complex_kernel()</span></code></a>
to get further information and examples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>primal</strong> (<em>Callable</em>) – The primal function for the decorator.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The decorator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.cos">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">cos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.cos" title="Permalink to this definition">¶</a></dt>
<dd><p>The cosine function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cosine of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.cross">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">cross</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.cross" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the cross product with the input Vector (1-D Matrix).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>) – The input Vector (1-D Matrix) to perform the cross product.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The cross product result (1-D Matrix) of the two Vectors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.data_oriented">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">data_oriented</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.data_oriented" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks a class as Taichi compatible.</p>
<p>To allow for modularized code, Taichi provides this decorator so that
Taichi kernels can be defined inside a class.</p>
<p>See also <a class="reference external" href="https://docs.taichi.graphics/docs/lang/articles/advanced/odop">https://docs.taichi.graphics/docs/lang/articles/advanced/odop</a></p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">data_oriented</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">TiArray</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">inc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>            <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">TiArray</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">inc</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cls</strong> (<em>Class</em>) – the class to be decorated</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The decorated class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.deprecated">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">deprecated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">old</span></em>, <em class="sig-param"><span class="pre">new</span></em>, <em class="sig-param"><span class="pre">warning_type=&lt;class</span> <span class="pre">'DeprecationWarning'&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.deprecated" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark an API as deprecated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old</strong> (<em>str</em>) – old method.</p></li>
<li><p><strong>new</strong> (<em>str</em>) – new method.</p></li>
<li><p><strong>warning_type</strong> (<em>builtin warning type</em>) – type of warning.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@deprecated</span><span class="p">(</span><span class="s1">&#39;ti.sqr(x)&#39;</span><span class="p">,</span> <span class="s1">&#39;x**2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sqr</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Decorated fuction with warning message</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.determinant">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">determinant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.determinant" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the determinant of a matrix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The matrix dimension should be less than or equal to 4.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The determinant of a matrix.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – Determinants of matrices with sizes &gt;= 5 are not supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.dot">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">dot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the dot product with the input Vector (1-D Matrix).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>) – The input Vector (1-D Matrix) to perform the dot product.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The dot product result (scalar) of the two Vectors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.eig">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">eig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.eig" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the eigenvalues and right eigenvectors of a real matrix.</p>
<p>Mathematical concept refers to <a class="reference external" href="https://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix">https://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix</a>.
2D implementation refers to <a class="reference internal" href="#taichi.lang.linalg.eig2x2" title="taichi.lang.linalg.eig2x2"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.linalg.eig2x2()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ti.Matrix</em><em>(</em><em>n</em><em>, </em><em>n</em><em>)</em>) – 2D Matrix for which the eigenvalues and right eigenvectors will be computed.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em>) – The datatype for the eigenvalues and right eigenvectors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The eigenvalues in complex form. Each row stores one eigenvalue. The first number of the eigenvalue represents the real part and the second number represents the imaginary part.
eigenvectors (ti.Matrix(n*2, n)): The eigenvectors in complex form. Each column stores one eigenvector. Each eigenvector consists of n entries, each of which is represented by two numbers for its real part and imaginary part.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>eigenvalues (ti.Matrix(n, 2))</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.exp">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>The exp function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>e</cite> to the <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="taichi.lang.ext_arr">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">ext_arr</span></span><a class="headerlink" href="#taichi.lang.ext_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#taichi.lang.kernel_arguments.ArgExtArray" title="taichi.lang.kernel_arguments.ArgExtArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArgExtArray</span></code></a>.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">to_numpy</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">ti</span><span class="o">.</span><span class="n">ext_arr</span><span class="p">()):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to_numpy</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>  <span class="c1"># `arr` will be filled with `x`&#39;s data.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="taichi.lang.extension">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">extension</span></span><a class="headerlink" href="#taichi.lang.extension" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">taichi_core.Extension</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.field">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">needs_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.field" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a Taichi field</p>
<p>A Taichi field can be viewed as an abstract N-dimensional array, hiding away
the complexity of how its underlying <a class="reference internal" href="#taichi.lang.snode.SNode" title="taichi.lang.snode.SNode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SNode</span></code></a> are
actually defined. The data in a Taichi field can be directly accessed by
a Taichi <a class="reference internal" href="#taichi.lang.kernel_impl.kernel" title="taichi.lang.kernel_impl.kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">kernel()</span></code></a>.</p>
<p>See also <a class="reference external" href="https://docs.taichi.graphics/docs/lang/articles/basic/field">https://docs.taichi.graphics/docs/lang/articles/basic/field</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<em>DataType</em>) – data type of the field.</p></li>
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – shape of the field</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>optional</em>) – name of the field</p></li>
<li><p><strong>offset</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – offset of the field domain</p></li>
<li><p><strong>needs_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether this field participates in autodiff
and thus needs an adjoint field to store the gradients.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>The code below shows how a Taichi field can be declared and defined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Equivalently</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ti</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">ij</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.floor">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">floor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.floor" title="Permalink to this definition">¶</a></dt>
<dd><p>The floor function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The greatest integer less than or equal to <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.floordiv">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">floordiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.floordiv" title="Permalink to this definition">¶</a></dt>
<dd><p>The floor division function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements not equal to zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The floor function of <cite>a</cite> divided by <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.func">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.func" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks a function as callable in Taichi-scope.</p>
<p>This decorator transforms a Python function into a Taichi one. Taichi
will JIT compile it into native instructions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fn</strong> (<em>Callable</em>) – The Python function to be decorated</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The decorated function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">func</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">foo</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>  <span class="c1"># 42</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.get_addr">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">get_addr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.get_addr" title="Permalink to this definition">¶</a></dt>
<dd><p>Query the memory address (on CUDA/x64) of field <cite>f</cite> at index <cite>indices</cite>.</p>
<p>Currently, this function can only be called inside a taichi kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>Union</em><em>[</em><em>ti.field</em><em>, </em><em>ti.Vector.field</em><em>, </em><em>ti.Matrix.field</em><em>]</em>) – Input taichi field for memory address query.</p></li>
<li><p><strong>indices</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>ti.Vector</em><em>(</em><em>)</em><em>]</em>) – The specified field indices of the query.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The memory address of <cite>f[indices]</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ti.u64</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.grouped">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">grouped</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.grouped" title="Permalink to this definition">¶</a></dt>
<dd><p>Groups a list of independent loop indices into a <a class="reference internal" href="#taichi.lang.matrix.Vector" title="taichi.lang.matrix.Vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">Vector()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Any</em>) – does the grouping only if <cite>x</cite> is a <a class="reference internal" href="#module-taichi.lang.ndrange" title="taichi.lang.ndrange"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndrange</span></code></a>.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">grouped</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">ndrange</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">I</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">I</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.has_pytorch">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">has_pytorch</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.has_pytorch" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether has pytorch in the current Python environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if has pytorch else False.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.insert_expr_stmt_if_ti_func">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">insert_expr_stmt_if_ti_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.insert_expr_stmt_if_ti_func" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is used only for real functions. It inserts a
FrontendExprStmt to the C++ AST to hold the function call if <cite>func</cite> is a
Taichi function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – The function to be called.</p></li>
<li><p><strong>args</strong> – The arguments of the function call.</p></li>
<li><p><strong>kwargs</strong> – The keyword arguments of the function call.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The return value of the function call if it’s a non-Taichi function.
Returns None if it’s a Taichi function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.inversed">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">inversed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.inversed" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse of a matrix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The matrix dimension should be less than or equal to 4.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The inverse of a matrix.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – Inversions of matrices with sizes &gt;= 5 are not supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.is_arch_supported">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">is_arch_supported</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arch</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.is_arch_supported" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether an arch is supported on the machine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arch</strong> (<em>taichi_core.Arch</em>) – Specified arch.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether <cite>arch</cite> is supported on the machine.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.is_extension_supported">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">is_extension_supported</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.is_extension_supported" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether an extension is supported on an arch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arch</strong> (<em>taichi_core.Arch</em>) – Specified arch.</p></li>
<li><p><strong>ext</strong> (<em>taichi_core.Extension</em>) – Specified extension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether <cite>ext</cite> is supported on <cite>arch</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.kernel">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks a function as a Taichi kernel.</p>
<p>A Taichi kernel is a function written in Python, and gets JIT compiled by
Taichi into native CPU/GPU instructions (e.g. a series of CUDA kernels).
The top-level <code class="docutils literal notranslate"><span class="pre">for</span></code> loops are automatically parallelized, and distributed
to either a CPU thread pool or massively parallel GPUs.</p>
<p>Kernel’s gradient kernel would be generated automatically by the AutoDiff system.</p>
<p>See also <a class="reference external" href="https://docs.taichi.graphics/docs/lang/articles/basic/syntax#kernels">https://docs.taichi.graphics/docs/lang/articles/basic/syntax#kernels</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fn</strong> (<em>Callable</em>) – the Python function to be decorated</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The decorated function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">i32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Assigns all the elements of `x` in parallel.</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.kernel_profiler_total_time">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">kernel_profiler_total_time</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.kernel_profiler_total_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Get elapsed time of all kernels recorded in KernelProfiler.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>total time in second</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>time (double)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.log">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.log" title="Permalink to this definition">¶</a></dt>
<dd><p>The natural logarithm function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements greater than zero.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The natural logarithm of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.logical_and">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">logical_and</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.logical_and" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bitwise-and</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS bitwise-and with RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.logical_not">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">logical_not</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.logical_not" title="Permalink to this definition">¶</a></dt>
<dd><p>The logical not function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>1</cite> iff <cite>a=0</cite>, otherwise <cite>0</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.logical_or">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">logical_or</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.logical_or" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes bitwise-or</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value LHS</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – value RHS</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>LHS bitwise-or with RHS</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, bool]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.max">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.max" title="Permalink to this definition">¶</a></dt>
<dd><p>The maxnimum function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The maxnimum of <cite>a</cite> and <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.min">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.min" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The minimum of <cite>a</cite> and <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.mod">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.mod" title="Permalink to this definition">¶</a></dt>
<dd><p>The remainder function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements not equal to zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The remainder of <cite>a</cite> divided by <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.mul">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">mul</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.mul" title="Permalink to this definition">¶</a></dt>
<dd><p>The multiply function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>a</cite> multiplied by <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.ndarray">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">ndarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.ndarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a Taichi ndarray with scalar elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<em>DataType</em>) – Data type of the ndarray.</p></li>
<li><p><strong>shape</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>tuple</em><em>[</em><em>int</em><em>]</em><em>]</em>) – Shape of the ndarray.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>The code below shows how a Taichi ndarray with scalar elements can be declared and defined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.neg">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">neg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.neg" title="Permalink to this definition">¶</a></dt>
<dd><p>The negate function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The negative value of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.normalized">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">normalized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.normalized" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize a vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eps</strong> (<em>Number</em>) – a safe-guard value for sqrt, usually 0.</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">Vector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">a</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span> <span class="c1"># [3 / 5, 4 / 5]</span>
<span class="c1"># `a.normalized()` is equivalent to `a / a.norm()`.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only vector normalization is supported.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.one">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">one</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.one" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill the input field with one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>DataType</em>) – The input field to fill.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output field, which keeps the shape but filled with one.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.outer_product">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">outer_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.outer_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the outer product with the input Vector (1-D Matrix).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>other</strong> (<a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>) – The input Vector (1-D Matrix) to perform the outer product.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The outer product result (Matrix) of the two Vectors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.parallelize">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">parallelize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg0</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#taichi.lang.parallelize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.polar_decompose">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">polar_decompose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.polar_decompose" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform polar decomposition (A=UP) for arbitrary size matrix.</p>
<p>Mathematical concept refers to <a class="reference external" href="https://en.wikipedia.org/wiki/Polar_decomposition">https://en.wikipedia.org/wiki/Polar_decomposition</a>.
This is only a wrapper for <a class="reference internal" href="#taichi.lang.linalg.polar_decompose" title="taichi.lang.linalg.polar_decompose"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.linalg.polar_decompose()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ti.Matrix</em><em>(</em><em>n</em><em>, </em><em>n</em><em>)</em>) – input nxn matrix <cite>A</cite>.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em>) – date type of elements in matrix <cite>A</cite>, typically accepts ti.f32 or ti.f64.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Decomposed nxn matrices <cite>U</cite> and <cite>P</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.pow">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">pow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.pow" title="Permalink to this definition">¶</a></dt>
<dd><p>The power function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>a</cite> to the <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.prepare_sandbox">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">prepare_sandbox</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.prepare_sandbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a temporary directory, which will be automatically deleted on exit.
It may contain the taichi_core shared object or some misc. files.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.print_kernel_profile_info">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">print_kernel_profile_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.print_kernel_profile_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the elapsed time(min,max,avg) of Taichi kernels on devices.
To enable this profiler, set <cite>kernel_profiler=True</cite> in <cite>ti.init</cite>.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">taichi</span> <span class="k">as</span> <span class="nn">ti</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ti</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">cpu</span><span class="p">,</span> <span class="n">kernel_profiler</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">compute</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">compute</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ti</span><span class="o">.</span><span class="n">print_kernel_profile_info</span><span class="p">()</span> <span class="c1">#[1]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>[1] Currently the result of <cite>KernelProfiler</cite> could be incorrect on OpenGL
backend due to its lack of support for <cite>ti.sync()</cite>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.print_memory_profile_info">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">print_memory_profile_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.print_memory_profile_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Memory profiling tool for LLVM backends with full sparse support.
This profiler is automatically on.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.pyfunc">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">pyfunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.pyfunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Marks a function as callable in both Taichi and Python scopes.</p>
<p>When called inside the Taichi scope, Taichi will JIT compile it into
native instructions. Otherwise it will be invoked directly as a
Python function.</p>
<p>See also <a class="reference internal" href="#taichi.lang.kernel_impl.func" title="taichi.lang.kernel_impl.func"><code class="xref py py-func docutils literal notranslate"><span class="pre">func()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fn</strong> (<em>Callable</em>) – The Python function to be decorated</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The decorated function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="taichi.lang.quant">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">quant</span></span><a class="headerlink" href="#taichi.lang.quant" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#taichi.lang.quant_impl.Quant" title="taichi.lang.quant_impl.Quant"><code class="xref py py-class docutils literal notranslate"><span class="pre">taichi.lang.quant_impl.Quant</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.query_kernel_profile_info">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">query_kernel_profile_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.query_kernel_profile_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Query kernel elapsed time(min,avg,max) on devices using the kernel name.
To enable this profiler, set <cite>kernel_profiler=True</cite> in <cite>ti.init</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – kernel name.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>struct KernelProfilerQueryResult with member varaibles(counter, min, max, avg)</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">taichi</span> <span class="k">as</span> <span class="nn">ti</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ti</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">cpu</span><span class="p">,</span> <span class="n">kernel_profiler</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">f32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">fill</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">fill</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ti</span><span class="o">.</span><span class="n">clear_kernel_profile_info</span><span class="p">()</span> <span class="c1">#[1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fill</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query_result</span> <span class="o">=</span> <span class="n">ti</span><span class="o">.</span><span class="n">query_kernel_profile_info</span><span class="p">(</span><span class="n">fill</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span> <span class="c1">#[2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;kernel excuted times =&quot;</span><span class="p">,</span><span class="n">query_result</span><span class="o">.</span><span class="n">counter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;kernel elapsed time(min_in_ms) =&quot;</span><span class="p">,</span><span class="n">query_result</span><span class="o">.</span><span class="n">min</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;kernel elapsed time(max_in_ms) =&quot;</span><span class="p">,</span><span class="n">query_result</span><span class="o">.</span><span class="n">max</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;kernel elapsed time(avg_in_ms) =&quot;</span><span class="p">,</span><span class="n">query_result</span><span class="o">.</span><span class="n">avg</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>[1] To get the correct result, query_kernel_profile_info() must be used in conjunction with
clear_kernel_profile_info().</p>
<p>[2] Currently the result of <cite>KernelProfiler</cite> could be incorrect on OpenGL
backend due to its lack of support for <cite>ti.sync()</cite>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.randn">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">randn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.randn" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a random number from standard normal distribution.</p>
<p>Implementation refers to <a class="reference internal" href="#taichi.lang.random.randn" title="taichi.lang.random.randn"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.random.randn()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dt</strong> (<em>DataType</em>) – The datatype for the generated random number.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The generated random number.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.raw_div">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">raw_div</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.raw_div" title="Permalink to this definition">¶</a></dt>
<dd><p>Raw_div function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements not equal to zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>If <cite>a</cite> is a <cite>int</cite> and <cite>b</cite> is a <cite>int</cite>, then return <cite>a//b</cite>. Else return <cite>a/b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.raw_mod">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">raw_mod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.raw_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Raw_mod function. Both <cite>a</cite> and <cite>b</cite> can be <cite>float</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements not equal to zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The remainder of <cite>a</cite> divided by <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.rescale_index">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">rescale_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">I</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.rescale_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Rescales the index ‘I’ of field ‘a’ the match the shape of field ‘b’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>ti.field</em><em>(</em><em>)</em><em>, </em><em>ti.Vector.field</em><em>, </em><em>ti.Matrix.field</em><em>(</em><em>)</em>) – input taichi field</p></li>
<li><p><strong>b</strong> (<em>ti.field</em><em>(</em><em>)</em><em>, </em><em>ti.Vector.field</em><em>, </em><em>ti.Matrix.field</em><em>(</em><em>)</em>) – output taichi field</p></li>
<li><p><strong>I</strong> (<em>ti.Vector</em><em>(</em><em>)</em>) – grouped loop index</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Ib</strong> – rescaled grouped loop index</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ti.Vector()</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.rsqrt">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">rsqrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.rsqrt" title="Permalink to this definition">¶</a></dt>
<dd><p>The reciprocal of the square root function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The reciprocal of <cite>sqrt(a)</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.sin">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">sin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.sin" title="Permalink to this definition">¶</a></dt>
<dd><p>The sine function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Sine of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.sqrt">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">sqrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.sqrt" title="Permalink to this definition">¶</a></dt>
<dd><p>The square root function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements not less than zero.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>x</cite> such that <cite>x&gt;=0</cite> and <cite>x^2=a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.static">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">static</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">xs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.static" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates a Taichi-scope expression at compile time.</p>
<p><cite>static()</cite> is what enables the so-called metaprogramming in Taichi. It is
in many ways similar to <code class="docutils literal notranslate"><span class="pre">constexpr</span></code> in C++11.</p>
<p>See also <a class="reference external" href="https://docs.taichi.graphics/docs/lang/articles/advanced/meta">https://docs.taichi.graphics/docs/lang/articles/advanced/meta</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Any</em>) – an expression to be evaluated</p></li>
<li><p><strong>*xs</strong> (<em>Any</em>) – for Python-ish swapping assignment</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>The most common usage of <cite>static()</cite> is for compile-time evaluation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">if</span> <span class="n">ti</span><span class="o">.</span><span class="n">static</span><span class="p">(</span><span class="n">FOO</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">do_a</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">do_b</span><span class="p">()</span>
</pre></div>
</div>
<p>Depending on the value of <code class="docutils literal notranslate"><span class="pre">FOO</span></code>, <code class="docutils literal notranslate"><span class="pre">run()</span></code> will be directly compiled
into either <code class="docutils literal notranslate"><span class="pre">do_a()</span></code> or <code class="docutils literal notranslate"><span class="pre">do_b()</span></code>. Thus there won’t be a runtime
condition check.</p>
<p>Another common usage is for compile-time loop unrolling:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ti</span><span class="o">.</span><span class="n">static</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The above is equivalent to:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@ti</span><span class="o">.</span><span class="n">kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.sub">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">sub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.sub" title="Permalink to this definition">¶</a></dt>
<dd><p>The sub function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>a</cite> subtract <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.supported_archs">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">supported_archs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.supported_archs" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all supported archs on the machine.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>All supported archs on the machine.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List[taichi_core.Arch]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.svd">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">svd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.svd" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform singular value decomposition (A=USV^T) for arbitrary size matrix.</p>
<p>Mathematical concept refers to <a class="reference external" href="https://en.wikipedia.org/wiki/Singular_value_decomposition">https://en.wikipedia.org/wiki/Singular_value_decomposition</a>.
This is only a wrappers for <a class="reference internal" href="#taichi.lang.linalg.svd" title="taichi.lang.linalg.svd"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.linalg.svd()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ti.Matrix</em><em>(</em><em>n</em><em>, </em><em>n</em><em>)</em>) – input nxn matrix <cite>A</cite>.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em>) – date type of elements in matrix <cite>A</cite>, typically accepts ti.f32 or ti.f64.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Decomposed nxn matrices <cite>U</cite>, ‘S’ and <cite>V</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.sym_eig">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">sym_eig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.sym_eig" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the eigenvalues and right eigenvectors of a real symmetric matrix.</p>
<p>Mathematical concept refers to <a class="reference external" href="https://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix">https://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix</a>.
2D implementation refers to <a class="reference internal" href="#taichi.lang.linalg.sym_eig2x2" title="taichi.lang.linalg.sym_eig2x2"><code class="xref py py-func docutils literal notranslate"><span class="pre">taichi.lang.linalg.sym_eig2x2()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>ti.Matrix</em><em>(</em><em>n</em><em>, </em><em>n</em><em>)</em>) – Symmetric Matrix for which the eigenvalues and right eigenvectors will be computed.</p></li>
<li><p><strong>dt</strong> (<em>DataType</em>) – The datatype for the eigenvalues and right eigenvectors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The eigenvalues. Each entry store one eigen value.
eigenvectors (ti.Matrix(n, n)): The eigenvectors. Each column stores one eigenvector.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>eigenvalues (ti.Vector(n))</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.tan">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">tan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.tan" title="Permalink to this definition">¶</a></dt>
<dd><p>The tangent function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tangent of <cite>a</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.tanh">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">tanh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.tanh" title="Permalink to this definition">¶</a></dt>
<dd><p>The hyperbolic tangent function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>(e**x - e**(-x)) / (e**x + e**(-x))</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="taichi.lang.template">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">template</span></span><a class="headerlink" href="#taichi.lang.template" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#taichi.lang.kernel_arguments.Template" title="taichi.lang.kernel_arguments.Template"><code class="xref py py-class docutils literal notranslate"><span class="pre">Template</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.to_numpy_type">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">to_numpy_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.to_numpy_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert taichi data type to its counterpart in numpy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dt</strong> (<em>DataType</em>) – The desired data type to convert.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The counterpart data type in numpy.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.to_pytorch_type">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">to_pytorch_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.to_pytorch_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert taichi data type to its counterpart in torch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dt</strong> (<em>DataType</em>) – The desired data type to convert.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The counterpart data type in torch.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.to_taichi_type">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">to_taichi_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.to_taichi_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert numpy or torch data type to its counterpart in taichi.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dt</strong> (<em>DataType</em>) – The desired data type to convert.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The counterpart data type in taichi.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.tr">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">tr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.tr" title="Permalink to this definition">¶</a></dt>
<dd><p>The sum of a matrix diagonal elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The sum of a matrix diagonal elements.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.truediv">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">truediv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.truediv" title="Permalink to this definition">¶</a></dt>
<dd><p>True division function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix.</p></li>
<li><p><strong>b</strong> (Union[<a class="reference internal" href="#taichi.lang.expr.Expr" title="taichi.lang.expr.Expr"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>, <a class="reference internal" href="#taichi.lang.matrix.Matrix" title="taichi.lang.matrix.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix</span></code></a>]) – A number or a matrix with elements not equal to zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The true value of <cite>a</cite> divided by <cite>b</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.vectorize">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">vectorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg0</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#taichi.lang.vectorize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.warning">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">warning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">msg</span></em>, <em class="sig-param"><span class="pre">type=&lt;class</span> <span class="pre">'UserWarning'&gt;</span></em>, <em class="sig-param"><span class="pre">stacklevel=1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.warning" title="Permalink to this definition">¶</a></dt>
<dd><p>Print warning message</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<em>str</em>) – massage to print.</p></li>
<li><p><strong>type</strong> (<em>builtin warning type</em>) – type of warning.</p></li>
<li><p><strong>stacklevel</strong> (<em>int</em>) – warning stack level from the caller.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.lang.zero">
<span class="sig-prename descclassname"><span class="pre">taichi.lang.</span></span><span class="sig-name descname"><span class="pre">zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.lang.zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill the input field with zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>DataType</em>) – The input field to fill.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output field, which keeps the shape but filled with zero.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataType</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">taichi-api-docstring</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Taichi Graphics.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/src/taichi.lang.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>